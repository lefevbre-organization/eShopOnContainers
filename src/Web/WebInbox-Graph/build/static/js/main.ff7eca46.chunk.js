(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{166:function(e,t,a){e.exports=a(428)},22:function(e,t){e.exports={appId:"0803434b-369f-4e1f-973b-85aa480dcf16",scopes:["user.read","calendars.read","mail.read","mail.readwrite","mail.send"]}},280:function(e,t,a){},373:function(e,t,a){},374:function(e,t,a){},380:function(e,t,a){},392:function(e,t,a){},415:function(e,t,a){},416:function(e,t,a){},417:function(e,t,a){},418:function(e,t,a){},419:function(e,t,a){},420:function(e,t,a){},422:function(e,t){},425:function(e,t,a){},427:function(e,t,a){},428:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(18),i=a.n(r),c=a(23),o=a(17),l=a(152),u=a(7),d="SIGNED_OUT",p={url:{URL_UPDATE_DEFAULTACCOUNT:"https://useraccounts.azurewebsites.net/api/accounts/defaultaccount",URL_RESET_DEFAULTACCOUNT:"https://useraccounts.azurewebsites.net/api/accounts/resetdefaultaccount",URL_DELETE_ACCOUNT:"https://useraccounts.azurewebsites.net/api/accounts/deleteaccount",URL_SELECT_ACCOUNT:"https://lefebvre-approot.azurewebsites.net"}},m=function(e){return function(t){t({type:"STORE_USER",userId:e})}},h={userId:""},g=function(e){var t=null;if("string"!==typeof e)return t;var a=e.match(/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,.*/);return a&&a.length&&(t=a[1]),t},f=a(22),b=a.n(f),v=a(5),E=a(6),y=a(11),O=a(8),j=a(10),k=a(2),S=a(433),T="ADD_MESSAGE",M="DELETE_MESSAGE",C="DELETE_LIST_MESSAGES",w="ADD_LIST_MESSAGES",N=function(e){var t=e.labelIds,a=(e.q,e.pageToken);return function(e,n){e(_());var s=n(),r=s.searchQuery;if(""!==r&&e(xe("-1")),null!=s.messagesResult.paginatioDirectionSelected)if("prev"==s.messagesResult.paginatioDirectionSelected){var i=s.messagesResult["@odata.nextLink"].split("skip=")[1];a=s.messagesResult["@odata.nextLink"].split("skip=")[0]+"skip="+(i-40)}else a=s.messagesResult["@odata.nextLink"];delete s.messagesResult,Ee({labelIds:t,maxResults:20,q:r,pageToken:a}).then(function(t){e({type:"GET_MESSAGES",payload:t}),e(A())}).catch(function(t){e({type:"GET_MESSAGES_FAILED",payload:t})})}},x=function(e){return{type:"SET_SEARCH_QUERY",payload:e}},A=function(e){return{type:"SET_PAGE_TOKENS",payload:e}},L=function(){return{type:"EMPTY_MESSAGES"}},I=function(e,t){return{type:"TOGGLE_SELECTED",payload:{messageIds:e,selected:t}}},R=function(e){return function(t){t(P()),Se(e).then(function(e){t({type:"MESSAGE_LOAD_SUCCESS",payload:e})}).catch(function(e){t({type:"MESSAGE_LOAD_FAIL",payload:e})})}},P=function(){return{type:"MESSAGE_LOAD_IN_PROGRESS"}},_=function(){return{type:"GET_MESSAGES_LOAD_IN_PROGRESS"}},D=function(e){return{type:"ADD_INITIAL_PAGE_TOKEN",payload:e}},U=function(){return{type:"CLEAR_PAGE_TOKENS"}},G=function(e){var t=e.ids,a=e.addLabelIds,n=void 0===a?[]:a,s=e.removeLabelIds,r=void 0===s?[]:s;return function(e){we({ids:t,addLabelIds:n,removeLabelIds:r}).then(function(t){e({type:"MODIFY_MESSAGES_SUCCESS",payload:{modifiedIds:t,addLabelIds:n,removeLabelIds:r}})}).catch(function(t){e({type:"MODIFY_MESSAGES_FAILED"})})}},F=function(e){return function(t){t({type:T,data:{id:e,content:e}})}},H=function(e){return function(t){t({type:M,data:{id:e,content:e}})}},z=function(e){return function(t){t({type:C,listMessages:e})}},B=function(e){return function(t){t({type:w,listMessages:e})}},Q=a(15),Y=a(16),q=a(24),V=a(37),W=a(21),K=function(e){var t=[];if(!e||""===e.trim())return t;for(var a=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,n=e.trim().replace(/[;\s]/g,",").split(","),s=0;s<n.length;s++){var r=n[s];if(""!==r){if(!a.test(r)){t=[];break}t.push(r)}}return t},Z=function(e){if(!e)return null;var t,a,n;return null!==(t=/(?:"?([^"]*)"?\s)?(?:<?(.+@[^>]+)>?)/.exec(e))&&(n=t[2],a=t[1]||n.slice(0,n.indexOf("@"))),{name:a,email:n}},J=a(9),$=a(156),X=a.n($),ee=(a(279),a(280),a(35)),te=a(296),ae=a(319),ne=a(337),se=(ne.Dashboard,ne.DashboardModal,ne.DragDrop),re=ne.ProgressBar,ie=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).state={displayModal:!1,to:e.to||"",cc:e.cc||"",bcc:e.bcc||"",subject:e.subject||"",content:e.content||"",showInlineDashboard:!1,open:!1,uppyPreviews:[]},a.showModal=a.showModal.bind(Object(k.a)(Object(k.a)(a))),a.closeModal=a.closeModal.bind(Object(k.a)(Object(k.a)(a))),a.handleChange=a.handleChange.bind(Object(k.a)(Object(k.a)(a))),a.sendEmail=a.sendEmail.bind(Object(k.a)(Object(k.a)(a))),a.setField=a.setField.bind(Object(k.a)(Object(k.a)(a))),a.uppy=new ee({id:"uppy1",autoProceed:!1,debug:!0}).use(te,{endpoint:"https://master.tus.io/files/"}).use(ae,{serverUrl:"https://companion.uppy.io"}),a.reader=new FileReader,a.handleModalClick=a.handleModalClick.bind(Object(k.a)(Object(k.a)(a))),a.uploadFile=a.uploadFile.bind(Object(k.a)(Object(k.a)(a))),a.addFileToState=a.addFileToState.bind(Object(k.a)(Object(k.a)(a))),a.uppy.on("complete",function(e){console.log("Upload complete! We\ufffdve uploaded these files:",e.successful)}),a.uppy.on("file-added",function(e){console.log("Added file",e),a.reader.onload=function(t){return a.addFileToState({file:e,base64:t.target.result})},a.reader.readAsDataURL(e.data)}),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"addFileToState",value:function(e){var t=e.file,a=e.base64;this.setState({uppyPreviews:[{file:t,base64:a}].concat(Object(W.a)(this.state.uppyPreviews))})}},{key:"uploadFile",value:function(){console.log(this.state.uppyPreviews)}},{key:"componentWillUnmount",value:function(){this.uppy.close()}},{key:"handleModalClick",value:function(){this.setState({open:!this.state.open})}},{key:"showModal",value:function(){this.setState({displayModal:!0})}},{key:"closeModal",value:function(){this.setState({displayModal:!1}),this.uppy.close(),this.state.uppyPreviews=[],this.uppy.reset()}},{key:"handleChange",value:function(e){this.setState({content:e})}},{key:"sendEmail",value:function(){var e=this,t=K(this.state.to);if(t.length&&""!==this.state.subject.trim()&&""!==this.state.content){var a={To:t.join(", "),Subject:this.state.subject,attachments:this.state.uppyPreviews},n=K(this.state.cc);n.length&&(a.Cc=n.join(", "));var s=K(this.state.bcc);s.length&&(a.Bcc=s.join(", "));var r=this.state.uppyPreviews;Ce({data:this.state,attachments:r}).then(function(t){e.closeModal(),e.resetFields()})}}},{key:"resetFields",value:function(){this.setState({to:this.props.to||"",cc:this.props.cc||"",bcc:this.props.bcc||"",subject:this.props.subject||"",content:this.props.content||"",uppyPreviews:[]})}},{key:"setField",value:function(e){var t=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(n){t.setState(Object(V.a)({},e,a?n.target.value.trim():n.target.value))}}},{key:"isInvalid",value:function(e){var t=this.state[e].trim();return t.length>0&&!K(t).length}},{key:"render",value:function(){this.state.showInlineDashboard;var e=this.props.t;return s.a.createElement(s.a.Fragment,null,s.a.cloneElement(this.props.children,{onClick:this.showModal}),this.state.displayModal?s.a.createElement(J.i,{isOpen:this.state.displayModal,className:"compose-dialog",size:"lg","overflow-y":"initial !important",onOpened:this.onModalOpened,backdrop:"static",centered:!0},s.a.createElement(J.l,{toggle:this.closeModal},e("compose-message.compose-message")),s.a.createElement(J.j,null,s.a.createElement("div",{className:"message-fields"},s.a.createElement(J.g,null,s.a.createElement(J.h,{addonType:"prepend"},e("compose-message.to")),s.a.createElement(J.f,{tabIndex:1,value:this.state.to,placeholder:e("compose-message.comma-separated"),invalid:this.isInvalid("to"),onChange:this.setField("to")})),s.a.createElement(J.g,null,s.a.createElement(J.h,{addonType:"prepend"},"Cc:"),s.a.createElement(J.f,{tabIndex:2,value:this.state.cc,placeholder:e("compose-message.comma-separated"),invalid:this.isInvalid("cc"),onChange:this.setField("cc")})),s.a.createElement(J.g,null,s.a.createElement(J.h,{addonType:"prepend"},"Bcc:"),s.a.createElement(J.f,{tabIndex:3,placeholder:e("compose-message.comma-separated"),invalid:this.isInvalid("bcc"),onChange:this.setField("bcc")})),s.a.createElement(J.g,null,s.a.createElement(J.h,{addonType:"prepend"},e("compose-message.subject")),s.a.createElement(J.f,{tabIndex:4,placeholder:"",value:this.state.subject,onChange:this.setField("subject",!1)}))),s.a.createElement("div",{className:"editor-wrapper"},s.a.createElement(X.a,{tabIndex:5,value:this.state.content,onChange:this.handleChange}))),s.a.createElement(J.k,{className:"footer"},s.a.createElement(J.a,{className:"mr-auto font-weight-bold",size:"lg",color:"primary",onClick:this.sendEmail,title:e("compose-message.send-message")},e("compose-message.send"))," ",s.a.createElement(J.a,{title:e("compose-message.discard"),color:"light",onClick:this.closeModal},s.a.createElement(Q.a,{icon:Y.i}))),s.a.createElement("div",{className:"ImagePreviewContainer"},this.state.uppyPreviews.map(function(e){return s.a.createElement("object",{className:"FileList",key:e.file.id,type:e.file.type,width:"80px",height:"auto",data:e.base64},e.file.name)})),s.a.createElement(re,{uppy:this.uppy,hideAfterFinish:!1}),s.a.createElement("div",{id:"Divfooter"},s.a.createElement(se,{uppy:this.uppy,width:"100%",height:"130px","min-height":"130px"}))):null)}}]),t}(n.PureComponent),ce=Object(q.c)()(ie),oe=a(43),le=a.n(oe),ue=(a(373),function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).trashHandler=a.getClickHandler(["TRASH"]),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"getClickHandler",value:function(e){var t=this;return function(a){t.props.onClick(e)}}},{key:"render",value:function(){var e=this.props.t;if(!this.props.messageResult.result)return null;var t,a,n,r=this.props.messageResult.result.messageHeaders;n=r.subject,t=r.from.emailAddress.address;for(var i=0;i<r.ccRecipients.length;i++)a=r.ccRecipients[i].emailAddress.address;var c=Z(t),o=le()(r.receivedDateTime);o.isValid()||(o=le()(parseInt(this.props.messageResult.result.internalDate)));var l="<p>On ".concat(o.format("MMMM Do YYYY, h:mm:ss a")," < ").concat(c.email," > wrote:</p>"),d=Object(u.a)({subject:"Re: ".concat(n),to:c.email,content:"<p>&nbsp;</p>\n          <p>&nbsp;</p>\n          <p>&nbsp;</p>\n          ".concat(l,"\n          <blockquote>").concat(this.props.messageResult.body.content,"</blockquote>")},a&&{cc:a.value});return s.a.createElement("div",{className:"d-flex justify-content-center align-items-center message-toolbar"},s.a.createElement("div",{className:"action-btns"},s.a.createElement("div",{className:"action-btn mr-2"},s.a.createElement("button",{className:"btn",onClick:this.trashHandler},s.a.createElement(Q.a,{title:e("message-toolbar.move-to-trash"),icon:Y.i,size:"lg"}))),s.a.createElement("div",{className:"action-btn mr-2"},s.a.createElement(ce,d,s.a.createElement("button",{className:"btn"},s.a.createElement(Q.a,{title:e("message-toolbar.reply"),icon:Y.f,size:"lg"}))))))}}]),t}(n.PureComponent)),de=Object(q.c)()(ue);a(374);function pe(e,t,a){t=t||"",a=a||512;for(var n=atob(e),s=[],r=0;r<n.length;r+=a){for(var i=n.slice(r,r+a),c=new Array(i.length),o=0;o<i.length;o++)c[o]=i.charCodeAt(o);var l=new Uint8Array(c);s.push(l)}return new Blob(s,{type:t})}function me(e,t){var a=document.createElement("a"),n=document.createTextNode(t);return a.appendChild(n),a.href=e,a.title=t,a.download=t,a.style.textDecoration="none",a.style.padding="5px",a.style.margin="15px 0",a.style.clear="both",a}function he(e){var t=document.createElement("span");t.style.whiteSpace="nowrap",t.style.backgroundColor="#fafafa",t.style.border="solid 1px #aaa",t.style.padding="5px",t.style.margin="10px",t.style.display="inline-block";var a=function(e){var t,a=document.createElement("img");switch(e){case"image/png":t="../assets/img/file-extensions/png.png";break;case"image/jpeg":t="../assets/img/file-extensions/jpg.png";break;case"application/pdf":t="../assets/img/file-extensions/pdf.png";break;case"text/plain":t="../assets/img/file-extensions/txt.png";break;case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":t="../assets/img/file-extensions/doc.png";break;default:t="../assets/img/file-extensions/default.png"}return a.src=t,a.style.alt="Attached file",a.style.display="inline-block",a.style.verticalAlign="middle",a}(e);return t.appendChild(a),t}var ge=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).state={errorMessage:void 0},a.iframeRef=s.a.createRef(),a.modifyMessage=a.modifyMessage.bind(Object(k.a)(Object(k.a)(a))),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(e){var t=this.props.match.params.id;this.props.getEmailMessage(t)}},{key:"componentDidUpdate",value:function(e){var t=this.props.emailMessageResult;if(!t.loading)if(t.failed)this.state.errorMessage||this.setState({errorMessage:"error",modal:!0});else if(this.iframeRef.current){var a=this.iframeRef.current.contentWindow.document.body;a.style.margin="0px",a.style.fontFamily="Arial, Helvetica, sans-serif",a.style.fontSize="13px",a.innerHTML=this.props.emailMessageResult.body.content;var n=t.attach;if("undefined"!==typeof n&&n.length>0){var s=document.getElementById("message-iframe"),r=function(){var e=document.createElement("div");return e.style.height="30px",e.id="Dividier",e}();s.contentDocument.body.appendChild(r);for(var i=0;i<n.length;i++){var c=pe(n[i].contentBytes.replace(/-/g,"+").replace(/_/g,"/"),n[i].contentType,n[i].size),o=me(URL.createObjectURL(c),n[i].name),l=he(n[i].contentType);l.appendChild(o),s.contentDocument.body.appendChild(l)}}}}},{key:"renderSpinner",value:function(){return s.a.createElement("div",{className:"d-flex h-100 justify-content-center align-items-center  "},s.a.createElement(Q.a,{icon:Y.h,spin:!0,size:"3x"}))}},{key:"renderErrorModal",value:function(){}},{key:"modifyMessage",value:function(e,t){var a=this.props.emailMessageResult.result.id,n=Object(u.a)({},e&&{addLabelIds:e},t&&{removeLabelIds:t});this.props.modifyMessages(Object(u.a)({ids:[a]},n)),this.props.history.goBack()}},{key:"render",value:function(){return this.props.emailMessageResult.loading?this.renderSpinner():s.a.createElement(s.a.Fragment,null,s.a.createElement(de,{onClick:this.modifyMessage,messageResult:this.props.emailMessageResult}),s.a.createElement("div",{className:"d-flex justify-content-center align-items-center message-content"},this.props.emailMessageResult.loading?this.renderSpinner():null,this.state.errorMessage?this.renderErrorModal():s.a.createElement("iframe",{ref:this.iframeRef,title:"Message contents",id:"message-iframe",style:{display:this.props.emailMessageResult.loading?"none":"block"}})))}}]),t}(n.Component),fe=Object(o.d)(S.a,Object(c.b)(function(e){return{emailMessageResult:e.emailMessageResult}},function(e){return Object(o.b)({getEmailMessage:R,modifyMessages:G},e)}))(ge),be=a(149);function ve(e){return be.Client.init({authProvider:function(t){t(null,e)}})}var Ee=function(e){var t=e.labelIds,a=e.maxResults,n=e.q,s=e.pageToken;return new Promise(function(e,r){Oe({labelIds:t,maxResults:a,pageToken:s,q:n}).then(je).then(function(a){return ye(a.messages,t).then(function(t){return e(Object(u.a)({},a,{messages:t.messages,label:t.label}))})}).catch(function(e){r(e)})})},ye=function(e,t){return new Promise(function(t,a){t({messages:e,label:{result:{messagesTotal:0}}})})},Oe=function(e){var t=e.labelIds,a=e.maxResults,n=e.pageToken,s=e.q,r=void 0===s?"":s;return new Promise(function(e,s){var i=ve(window.msal.acquireTokenSilent(b.a.scopes));null!=n?i.api("".concat(n)).get().then(function(t){e(t)}).catch(function(e){s(e)}):""==r?i.api("me/mailFolders/".concat(t,"/messages")).top("".concat(a)).get().then(function(t){e(t)}).catch(function(e){s(e)}):i.api("me/messages?$search=".concat(r)).top("".concat(a)).get().then(function(t){e(t)}).catch(function(e){s(e)})})},je=function(e){var t=e;return new Promise(function(e,a){var n=(t.value||[]).map(function(e){return ke(e.id)});Promise.all(n).then(function(a){return e(Object(u.a)({},t,{messages:a}))})})},ke=function(e){return new Promise(function(t,a){ve(window.msal.acquireTokenSilent(b.a.scopes)).api("me/messages/".concat(e)).get().then(function(e){return t(e)}).catch(function(e){a(e)})})},Se=function(e){return new Promise(function(t,a){Me(e).then(function(a){return Te(e).then(function(e){return t(Object(u.a)({},a,{attach:e}))})}).catch(function(e){a(e)})})},Te=function(e){return new Promise(function(t,a){ve(window.msal.acquireTokenSilent(b.a.scopes)).api("me/messages/".concat(e,"/attachments")).get().then(function(e){return t(e.value)}).catch(function(e){a(e)})})},Me=function(e){return new Promise(function(t,a){ve(window.msal.acquireTokenSilent(b.a.scopes)).api("me/messages/".concat(e)).get().then(function(e){var a=e,n=a.body;t({body:n,headers:e.headers,result:Object(u.a)({},a,{messageHeaders:a,payload:void 0})})}).catch(function(e){a(e)})})};var Ce=function(e){var t=e.data;e.attachments;return new Promise(function(e,a){var n="";n=function(e){var t=e.subject,a=e.content;return'{\n                  "Message": {\n                    "Subject": "'.concat(t,'",\n                    "Body": {\n                      "ContentType": "html",\n                      "Content": "').concat(a,'"\n                    },\r\n')}(t),n+=function(e){var t="[]";if(""===e.to)return t;for(var a=e.to.split(","),n=(t='"ToRecipients": [',0);n<a.length;n++)t+='{\n                        "EmailAddress": {\n                          "Address": "'.concat(a[n],'"\n                        }\n                      },\r\n');return t+="],\r\n"}(t),n+=function(e){var t='"CcRecipients": [],';if(""===e.cc)return t;var a=e.cc.split(",");t='"CcRecipients": [';for(var n=0;n<a.length;n++)t+='{\n                        "EmailAddress": {\n                          "Address": "'.concat(a[n],'"\n                        }\n                      },\r\n');return t+="],\r\n"}(t),n+=function(e){var t='"BccRecipients": [],';if(""===e.bcc)return t;var a=e.bcc.split(",");t='"BccRecipients": [';for(var n=0;n<a.length;n++)t+='{\n                        "EmailAddress": {\n                          "Address": "'.concat(a[n],'"\n                        }\n                      },\r\n');return t+="],\r\n"}(t),n+=function(e){var t,a='"Attachments": [],',n=e.uppyPreviews;if(n.length<=0)return a;a='"Attachments": [';for(var s=0;s<n.length;s++){g(n[s].base64);var r="string"!==typeof(t=n[s].base64)?null:t.split("base64,")[1],i=n[s].file.name;a+='{\n        "@odata.type": "#Microsoft.OutlookServices.FileAttachment",\n        "Name": "'.concat(i,'",\n        "ContentBytes": "').concat(r,'"\n      },\r\n')}return a+="],\r\n"}(t),n+='},\n                 "SaveToSentItems": "true"\n                  }';var s=window.msal.acquireTokenSilent(b.a.scopes);return ve(s).api("/me/sendmail").header("Authorization","Bearer "+s).header("Content-Type","application/json").post(n,function(t,a){e(a)})})},we=function(e){var t=e.ids;e.addLabelIds,e.removeLabelIds;return new Promise(function(e,a){var n=window.msal.acquireTokenSilent(b.a.scopes),s=ve(n),r='{\n                     "destinationId": "'.concat("deleteditems",'"\n                     }');return s.api("me/messages/".concat(t,"/move")).header("Authorization","Bearer "+n).header("Content-Type","application/json").post(r,function(a,n){e(t)})})},Ne=function(){return function(e){new Promise(function(e,t){ve(window.msal.acquireTokenSilent(b.a.scopes)).api("/me/mailFolders").get().then(function(t){e(t.value)})}).then(function(t){e({type:"GET_LABELS",payload:t})})}},xe=function(e){return function(t){t({type:"SELECT_LABEL",payload:e})}},Ae={labels:[]},Le=a(165),Ie={messages:[],loading:!0,pageTokens:[],paginatioDirectionSelected:null},Re={body:"",loading:!1,failed:!1},Pe={selectedMessages:[]};var _e=Object(o.c)({signedOutReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch((arguments.length>1?arguments[1]:void 0).type){case d:return{};default:return e}},signInStatusResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_IN_PROGRESS":return Object(u.a)({},e,{status:"AUTH_IN_PROGRESS"});case"AUTH_SUCCESS":return Object(u.a)({},e,{status:"AUTH_SUCCESS",currentUser:t.payload.currentUser});case"AUTH_FAIL":return Object(u.a)({},e,{status:"AUTH_FAIL"});case"SIGNED_IN":return Object(u.a)({},t.payload);case d:return Object(u.a)({},e,{status:"AUTH_SIGNED_OUT",currentUser:{}});default:return e}},storeUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STORE_USER":return Object(u.a)({},e,{userId:t.userId});default:return e}},labelsResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_LABELS":return console.log(t.payload),Object(u.a)({},e,{labels:t.payload});case"SELECT_LABEL":return Object(u.a)({},e,{labels:e.labels.map(function(e){return e.id===t.payload?Object(u.a)({},e,{selected:!0}):Object(u.a)({},e,{selected:!1})})});default:return e}},messagesResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_MESSAGES":var a=Object(u.a)({},e);a.nextPageToken=null;var n=Object(W.a)(a.pageTokens),s=t.payload["@odata.nextLink"];return s&&-1===n.indexOf(s)&&n.push(s),Object(u.a)({},a,t.payload,{loading:!1,pageTokens:n});case"GET_MESSAGES_FAILED":return Object(u.a)({},e,{loading:!1,failed:!0,error:t.payload});case"EMPTY_MESSAGES":return Object(u.a)({},e,{messages:[]});case"GET_MESSAGES_LOAD_IN_PROGRESS":return Object(u.a)({},e,{label:null,nextPageToken:null,loading:!0});case"TOGGLE_SELECTED":return Object(u.a)({},e,{messages:e.messages.map(function(e){return t.payload.messageIds.indexOf(e.id)>-1?Object(u.a)({},e,{selected:t.payload.selected}):e})});case"ADD_INITIAL_PAGE_TOKEN":return Object(u.a)({},e,{pageTokens:[t.payload]});case"CLEAR_PAGE_TOKENS":return Object(u.a)({},e,{pageTokens:[]});case"MODIFY_MESSAGES_SUCCESS":return Object(u.a)({},e,{messages:e.messages.filter(function(e){return-1===t.payload.modifiedIds.indexOf(e.id)})});default:return e}},emailMessageResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_MESSAGES_LOAD_IN_PROGRESS":case"MESSAGE_LOAD_IN_PROGRESS":return Object(u.a)({},e,{body:"",loading:!0,failed:!1});case"MESSAGE_LOAD_SUCCESS":var a=t.payload;return a.body,Object(Le.a)(a,["body"]),Object(u.a)({},e,t.payload,{loading:!1,failed:!1});case"MESSAGE_LOAD_FAIL":return Object(u.a)({},e,{loading:!1,failed:!0,error:t.payload});default:return e}},pageTokens:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{prevPageToken:"",nextPageToken:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PAGE_TOKENS":return Object(u.a)({},e,t.payload);default:return e}},searchQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SEARCH_QUERY":return t.payload;default:return e}},messageList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return-1===e.selectedMessages.findIndex(function(e){return e.id===t.data.id})?Object(u.a)({},e,{selectedMessages:[].concat(Object(W.a)(e.selectedMessages),[t.data])}):e;case M:return Object(u.a)({},e,{selectedMessages:e.selectedMessages.filter(function(e){return e.id!==t.data.id})});case C:for(var a=function(a){var n=e.selectedMessages.findIndex(function(e){return e.id===t.listMessages[a]});n>-1&&e.selectedMessages.splice(n,1)},n=0;n<t.listMessages.length;n++)a(n);return Object(u.a)({},e,{selectedMessages:e.selectedMessages});case w:var s=function(a){if(-1===e.selectedMessages.findIndex(function(e){return e.id===t.listMessages[a]})){var n={id:t.listMessages[a],content:t.listMessages[a]};e.selectedMessages.push(n)}};for(n=0;n<t.listMessages.length;n++)s(n);return Object(u.a)({},e,{selectedMessages:e.selectedMessages});default:return e}}});var De=a(100),Ue=a(161);De.a.use(Ue.a).init({lng:navigator.language,fallbackLng:"en",ns:["isotope"],defaultNS:"isotope",backend:{loadPath:"/assets/locales/{{lng}}/{{ns}}.json"},interpolation:{escapeValue:!1},react:{wait:!1,withRef:!1,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default",useSuspense:!1}});var Ge=De.a,Fe=(a(380),a(432)),He=a(431),ze=a(3),Be=a.n(ze),Qe=a(28),Ye=a(75),qe=a(149);function Ve(e){return qe.Client.init({authProvider:function(t){t(null,e)}})}function We(e){return Ke.apply(this,arguments)}function Ke(){return(Ke=Object(Qe.a)(Be.a.mark(function e(t){var a,n;return Be.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Ve(t),e.next=3,a.api("/me").get();case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}a(391),a(392);var Ze=a(430),Je=a(162),$e=a.n(Je),Xe=function(){return new Ye.UserAgentApplication(b.a.appId,null,null).logout(),!0},et=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).handleInputChange=a.handleInputChange.bind(Object(k.a)(Object(k.a)(a))),a.handleSearchClick=a.handleSearchClick.bind(Object(k.a)(Object(k.a)(a))),a._handleOnClick=a._handleOnClick.bind(Object(k.a)(Object(k.a)(a))),a.performSearch=$e()(a.performSearch.bind(Object(k.a)(Object(k.a)(a))),1e3),a.toggle=a.toggle.bind(Object(k.a)(Object(k.a)(a))),a.toggleMenu=a.toggleMenu.bind(Object(k.a)(Object(k.a)(a))),a.state={dropdownOpen:!1,dropdownMenuOpen:!1},a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"_handleOnClick",value:function(e){Xe();var t=this.props.userId;if(""!==t&&void 0!==t){var a="".concat(p.url.URL_DELETE_ACCOUNT);fetch(a,{method:"POST",body:JSON.stringify({user:t,provider:"OUTLOOK",email:this.props.microsoftUser.email}),headers:{"Content-type":"application/json"}}).then(function(e){return e.json()}).then(function(e){console.log(e)});var n="".concat(p.url.URL_SELECT_ACCOUNT,"/user/").concat(t,"/encrypt/0");window.open(n,"_self")}}},{key:"toggle",value:function(){this.setState({dropdownOpen:!this.state.dropdownOpen})}},{key:"toggleMenu",value:function(){this.setState({dropdownMenuOpen:!this.state.dropdownMenuOpen})}},{key:"handleSearchClick",value:function(e){""!==this.props.searhQuery&&this.performSearch()}},{key:"handleInputChange",value:function(e){this.props.setSearchQuery(e.target.value),this.performSearch()}},{key:"performSearch",value:function(){var e={};this.props.searchQuery&&""!==this.props.searchQuery||(e.labelIds=["INBOX"]),this.props.getLabelMessages(Object(u.a)({},e))}},{key:"render",value:function(){var e=this.props.microsoftUser,t=e.email,a=e.displayName;return s.a.createElement("header",{className:"d-flex p-3 align-content-center align-items-center header "},s.a.createElement("div",{className:"justify-content-left"},s.a.createElement(Ze.a,{to:"/inbox"},s.a.createElement("img",{border:"0",alt:"lefebvre",src:"assets/img/LogoLefebvre.png"}))),s.a.createElement("div",{className:"header-logo justify-content-center"}),s.a.createElement("div",{className:"header-search"},s.a.createElement("div",{className:"input-group w-75 ml-1 mr-auto"},s.a.createElement("input",{type:"search",className:"form-control search",placeholder:"Search mail",value:this.props.searchQuery,onChange:this.handleInputChange}),s.a.createElement("div",{className:"input-group-append",onClick:this.handleSearchClick},s.a.createElement("button",{className:"btn btn-light  bg-white text-dark btn-search",type:"button"},s.a.createElement(Q.a,{icon:Y.g})))),s.a.createElement("div",{className:"menu-user"},s.a.createElement(J.m,{className:"ml-auto",navbar:!0},s.a.createElement(J.n,{className:"d-md-down-none"},s.a.createElement(J.o,{href:"#"},s.a.createElement("i",{className:"icon-location-pin"}))),s.a.createElement(J.b,{nav:!0,isOpen:this.state.dropdownOpen,toggle:this.toggle},s.a.createElement(J.e,{nav:!0},s.a.createElement("img",{className:"mx-2 profile-pic",src:"assets/img/icon-user.png",alt:""})),s.a.createElement(J.d,{right:!0},s.a.createElement(J.c,{header:!0,tag:"div",className:"text-center"},s.a.createElement("strong",{title:t},a)),s.a.createElement(J.c,{divider:!0}),s.a.createElement(J.c,null,s.a.createElement("i",{className:"fa fa-shield"})," Add Account"),s.a.createElement(J.c,null,s.a.createElement("i",{className:"fa fa-shield"})," Create Account"),s.a.createElement(J.c,{divider:!0}),s.a.createElement(J.c,{onClick:this.props.onSignout},s.a.createElement("i",{className:"fa fa-lock"})," Logout"))))),s.a.createElement("div",null,s.a.createElement(J.m,{className:"ml-auto",navbar:!0},s.a.createElement(J.n,{className:"d-md-down-none"},s.a.createElement(J.o,{href:"#"},s.a.createElement("i",{className:"icon-location-pin"}))),s.a.createElement(J.b,{nav:!0,isOpen:this.state.dropdownMenuOpen,toggle:this.toggleMenu},s.a.createElement(J.e,{nav:!0},s.a.createElement("img",{className:"img-menu",src:"assets/img/icon-products.png",alt:""})),s.a.createElement(J.d,{right:!0},s.a.createElement(J.c,null,s.a.createElement("i",{className:"fa fa-shield"})," Calendar"),s.a.createElement(J.c,null,s.a.createElement("i",{className:"fa fa-shield"})," File Manager"),s.a.createElement(J.c,null,s.a.createElement("i",{className:"fa fa-shield"}),s.a.createElement("span",{onClick:this._handleOnClick}," Configure New Account")),s.a.createElement(J.c,{divider:!0}),s.a.createElement(J.c,null,s.a.createElement("i",{className:"fa fa-lock"})," Return to Lex-on")))))))}}]),t}(n.PureComponent),tt=Object(c.b)(function(e){return{userId:e.storeUser.userId}},function(e){return Object(o.b)({storeUser:m},e)})(et),at=a(42),nt=a.n(at),st=(a(396),a(163)),rt=a.n(st),it=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).onClick=a.onClick.bind(Object(k.a)(Object(k.a)(a))),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"onClick",value:function(e){this.props.onClick(e,this.props.id)}},{key:"render",value:function(){var e=this.props,t=e.name,a=e.messagesUnread,n=this.props.iconProps,r=this.props.selected?" selected":"",i=a.toLocaleString();return s.a.createElement("li",{className:"text-truncate text-left text-dark pl-4 pr-5 py-2 border-0 ".concat(r),title:t+(a>0?" (".concat(i,")"):""),onClick:this.onClick},s.a.createElement(Q.a,Object.assign({size:"sm"},n)),t,a>0?s.a.createElement("div",{className:"msg-count"},i):null)}}]),t}(n.PureComponent),ct=(a(415),function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).state={selectedLabel:e.pathname,selectedFolder:""},a.navigateToList=a.navigateToList.bind(Object(k.a)(Object(k.a)(a))),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){}},{key:"navigateToList",value:function(e,t){var a=this.props.labelsResult.labels.find(function(e){return e.id===t});this.setState({selectedFolder:t}),this.props.onLabelClick(a||{id:""})}},{key:"renderItems",value:function(e){if(0===e.length)return s.a.createElement("div",null);var t,a=e.reduce(function(e,t){return e.push(t),e},[]);return t=rt()(a,"displayName"),s.a.createElement(s.a.Fragment,null,this.renderLabels(t))}},{key:"renderLabels",value:function(e){var t=this,a=this.props.t,n=this.state.selectedFolder;return s.a.createElement(s.a.Fragment,null,s.a.createElement("li",{key:"olders-nav-title",className:"pl-2 nav-title"},a("sidebar.folders")),e.map(function(e){var a={icon:Y.d,color:e.color?e.color.backgroundColor:"gainsboro",size:"lg"};return""===n&&(n=e.id),s.a.createElement(it,{key:e.id+"_label",onClick:t.navigateToList,name:e.displayName,id:e.id,messagesUnread:e.totalItemCount,iconProps:a,selected:n===e.id})}))}},{key:"render",value:function(){var e=this.props.t;return s.a.createElement("nav",{className:"d-flex flex-column text-truncate left-panel"},s.a.createElement("div",{className:"compose-panel"},s.a.createElement("div",{className:"d-flex justify-content-center p-2 compose-btn"},s.a.createElement(ce,{subject:"",to:""},s.a.createElement("button",{className:"btn btn btn-outline-secondary uppercase align-self-center w-75 font-weight-bold uppercase"},e("sidebar.compose"))))),s.a.createElement(nt.a,{component:"ul",className:"d-flex flex-column border-0 m-0 sidebar"},this.renderItems(this.props.labelsResult.labels)))}}]),t}(n.PureComponent)),ot=Object(q.c)()(ct),lt=function(){return s.a.createElement("div",{className:"d-flex w-100 h-100 flex-column justify-content-center align-items-center"},s.a.createElement("div",null,s.a.createElement(Q.a,{icon:Y.c,size:"5x"})),s.a.createElement("div",{className:"h1"},"404 ERROR"),s.a.createElement("div",null,"The requested content was not found."))},ut=(a(416),a(417),function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).state={isChecked:!!e.checked},a.onChange=a.onChange.bind(Object(k.a)(Object(k.a)(a))),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"componentDidUpdate",value:function(e){e.checked!==this.props.checked&&this.setState({isChecked:this.props.checked})}},{key:"onChange",value:function(e){this.setState({isChecked:!this.state.isChecked}),this.props.onChange(e)}},{key:"render",value:function(){return s.a.createElement("label",{className:"custom-control fill-checkbox"},s.a.createElement("input",{checked:this.state.isChecked,type:"checkbox",onChange:this.props.onChange,className:"fill-control-input"}),s.a.createElement("span",{className:"fill-control-indicator"}),this.props.label?s.a.createElement("span",{className:"fill-control-description"},this.props.label):null)}}]),t}(n.PureComponent)),dt=function(e){return s.a.createElement("div",{className:"d-flex ml-2 justify-content-center align-items-center"},s.a.createElement(ut,{checked:e.selected,onChange:e.onChange}))},pt=function(e){return s.a.createElement("div",{className:"wrapper text-4"},s.a.createElement("div",{className:"wrapper align-items-center text-2"},s.a.createElement("div",{className:"text from-name"},e.fromName),s.a.createElement("div",{className:"text"},e.subject)))},mt=function(e){return s.a.createElement("div",{className:"wrapper num-4"},s.a.createElement("div",{className:"wrapper num-2"},s.a.createElement("div",{className:"num pr-4"},e.hasAttachment?s.a.createElement(Q.a,{icon:Y.e}):""),s.a.createElement("div",{className:"num pr-4"},e.formattedDate)))},ht=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).onSelectionChange=a.onSelectionChange.bind(Object(k.a)(Object(k.a)(a))),a.getMessage=a.getMessage.bind(Object(k.a)(Object(k.a)(a))),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"onSelectionChange",value:function(e){this.props.onSelectionChange(e.target.checked,this.props.data.id)}},{key:"getMessage",value:function(e){var t=encodeURI(this.props.data.id);this.props.history.push("/".concat(t))}},{key:"getFromName",value:function(e){return Z(e).name}},{key:"getFormattedDate",value:function(e,t){var a=le()(e);a.isValid()||(a=le()(t.parserFn(t.date)));var n=le()(new Date);return a.format("YYYYMMDD")===n.format("YYYYMMDD")?a.format("h:mm A"):a.year()!==n.year()?a.format("YYYY/MM/DD"):a.format("MMM D")}},{key:"render",value:function(){var e=this.props.data.receivedDateTime,t=this.getFormattedDate(e,{date:this.props.data.internalDate,parserFn:parseInt}),a=!1===this.props.data.isRead?" font-weight-bold":"",n=(this.props.data.bodyPreview,this.props.data.subject),r="";try{this.props.data.from.emailAddress.name.toUpperCase(),this.props.data.from.emailAddress.address;r=this.props.data.from.emailAddress.name}catch(i){}return s.a.createElement("div",{className:"d-flex table-row-wrapper".concat("")},s.a.createElement(dt,{selected:this.props.data.selected,onChange:this.onSelectionChange}),s.a.createElement("div",{onClick:this.getMessage,className:"table-row px-2 py-3".concat(a)},s.a.createElement(pt,{fromName:r,subject:n}),s.a.createElement(mt,{formattedDate:t,hasAttachment:this.props.data.hasAttachments})))}}]),t}(n.PureComponent),gt=Object(S.a)(ht),ft=function(e){var t=Object(q.b)().t;return s.a.createElement("div",{className:"btn-group ml-auto"},s.a.createElement("button",{onClick:e.navigateToPrevPage,disabled:null==e.prevToken,className:"btn btn-light bg-white border-1 border-dark px-3 btn-sm",title:t("pager-buttons.previous-page")},s.a.createElement(Q.a,{icon:Y.a})),s.a.createElement("button",{onClick:e.navigateToNextPage,disabled:null==e.nextToken,className:"btn btn-light bg-white border-1  border-dark px-3 btn-sm",title:t("pager-buttons.next-page")},s.a.createElement(Q.a,{icon:Y.b})))},bt=(a(418),function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).getClickHandler=a.getClickHandler.bind(Object(k.a)(Object(k.a)(a))),a.trashHandler=a.getClickHandler(["TRASH"]),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"getClickHandler",value:function(e){var t=this;return function(a){t.props.onClick(e)}}},{key:"render",value:function(){var e=this.props.t;return s.a.createElement("div",null,s.a.createElement("div",{className:"action-btn"},s.a.createElement(Q.a,{title:e("message-list.move-to-trash"),onClick:this.trashHandler,icon:Y.i,size:"lg"})))}}]),t}(n.PureComponent)),vt=Object(q.c)()(bt),Et=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).onSelectionChange=a.onSelectionChange.bind(Object(k.a)(Object(k.a)(a))),a.navigateToNextPage=a.navigateToNextPage.bind(Object(k.a)(Object(k.a)(a))),a.navigateToPrevPage=a.navigateToPrevPage.bind(Object(k.a)(Object(k.a)(a))),a.modifyMessages=a.modifyMessages.bind(Object(k.a)(Object(k.a)(a))),a.state={selectedMessageIds:[]},a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"onSelectionChange",value:function(e){var t=e.target.checked,a=this.props.messagesResult.messages.reduce(function(e,t){return e.push(t.id),e},[]);this.setState({selectedMessageIds:a}),this.props.toggleSelected(a,t),window.dispatchEvent(new CustomEvent("CheckAllclick",{detail:{listMessages:a,chkselected:t}})),t?this.props.addListMessages(a):this.props.deleteListMessages(a)}},{key:"navigateToNextPage",value:function(){this.props.messagesResult.paginatioDirectionSelected="next",this.props.getLabelMessages("","","")}},{key:"navigateToPrevPage",value:function(){this.props.messagesResult.paginatioDirectionSelected="prev",this.props.getLabelMessages("","","")}},{key:"modifyMessages",value:function(e,t){var a=this.props.messagesResult.messages.filter(function(e){return e.selected}).map(function(e){return e.id}),n=Object(u.a)({},e&&{addLabelIds:e},t&&{removeLabelIds:t});this.props.modifyMessages(Object(u.a)({ids:a},n))}},{key:"render",value:function(){var e=!1,t=[];return this.props.messagesResult&&(t=this.props.messagesResult.messages.filter(function(e){return e.selected}),e=this.props.messagesResult.messages.length>0&&t.length===this.props.messagesResult.messages.length),s.a.createElement("div",{className:"msg-toolbar"},s.a.createElement("div",{className:"pl-2 py-2 pr-4 d-flex align-items-center bd-highlight "},s.a.createElement("div",{className:"d-flex align-content-center align-items-center"},s.a.createElement("div",null,s.a.createElement(ut,{checked:e,onChange:this.onSelectionChange})),s.a.createElement("div",null),s.a.createElement("div",{className:"ml-auto p-2 bd-highlight"},s.a.createElement("div",null,t.length?s.a.createElement(vt,{onClick:this.modifyMessages}):null))),s.a.createElement(ft,{nextToken:this.props.nextToken,prevToken:this.props.prevToken,navigateToPrevPage:this.navigateToPrevPage,navigateToNextPage:this.navigateToNextPage,getLabelMessages:this.getLabelMessages})))}}]),t}(n.PureComponent),yt=Object(c.b)(function(e){return{messagesResult:e.messagesResult,selectedMessages:e.messageList.selectedMessages}},function(e){return Object(o.b)({toggleSelected:I,modifyMessages:G,deleteListMessages:z,addListMessages:B},e)})(Et),Ot=(a(419),function(e){function t(){return Object(v.a)(this,t),Object(y.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props.messagesTotal,t="";return e>0&&(t="".concat(e.toLocaleString()," messages")),s.a.createElement("div",{className:"mt-auto p-2  list-footer"},s.a.createElement("div",{className:"d-flex px-4 h-100 align-items-center"},s.a.createElement("div",{className:"total-count"},t),s.a.createElement("div",{className:"ml-auto "})))}}]),t}(n.PureComponent)),jt=(a(420),a(421),a(164)),kt=new(a.n(jt).a),St={LIST:1,CONTENT:2,EDIT:3},Tt=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).state={viewMode:St.LIST,contentMessageId:void 0,currentLabel:""},a.onSelectionChange=a.onSelectionChange.bind(Object(k.a)(Object(k.a)(a))),a.renderView=a.renderView.bind(Object(k.a)(Object(k.a)(a))),a.renderMessages=a.renderMessages.bind(Object(k.a)(Object(k.a)(a))),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.search,t=0===e.indexOf("?")?e.slice(1):null;t&&0===this.props.messagesResult.pageTokens.length&&this.props.addInitialPageToken(t);var a=""===this.props.searchQuery?[this.props.parentLabel.id]:void 0;this.props.getLabelMessages(Object(u.a)({},a&&{labelIds:a},{pageToken:t}))}},{key:"componentDidUpdate",value:function(e,t){if(e.location.search!==this.props.location.search){var a=this.props.location.search,n=0===a.indexOf("?")?a.slice(1):null,s=""===this.props.searchQuery?[this.props.parentLabel.id]:void 0;this.props.getLabelMessages(Object(u.a)({},s&&{labelIds:s},{pageToken:n}))}}},{key:"onSelectionChange",value:function(e,t){this.props.toggleSelected([t],e),window.dispatchEvent(new CustomEvent("Checkclick",{detail:{name:t,chkselected:e}})),e?this.props.addMessage(t):this.props.deleteMessage(t)}},{key:"renderSpinner",value:function(){return s.a.createElement("div",{className:"d-flex h-100 justify-content-center align-items-center  "},s.a.createElement(Q.a,{icon:Y.h,spin:!0,size:"3x"}))}},{key:"renderMessages",value:function(){var e=this,t=this.props.t;return this.props.messagesResult.loading?this.renderSpinner():0===this.props.messagesResult.messages.length?s.a.createElement("div",{className:"p-4 text-center"},t("message-list.no-message")):this.props.messagesResult.messages.map(function(t){return e.props.selectedMessages.find(function(e){return e.id===t.id})&&(t.selected=!0),s.a.createElement(gt,{data:t,key:t.id,onSelectionChange:e.onSelectionChange,onClick:e.getMessage})})}},{key:"renderView",value:function(){switch(this.state.viewMode){case St.EDIT:return this.renderEditView();default:return this.renderMessages()}}},{key:"getPageTokens",value:function(){return this.props.messagesResult.loading?{nextToken:null,prevToken:null}:(null!=this.props.messagesResult.pageTokens[0]&&(t=!0,this.props.messagesResult.pageTokens[0].split("skip=")[1]>20&&(e=!0)),{nextToken:t,prevToken:e});var e,t}},{key:"render",value:function(){var e=this.props.messagesResult,t=e.label?e.label.result.messagesTotal:0,a=this.getPageTokens(),n=a.nextToken,r=a.prevToken;return s.a.createElement(s.a.Fragment,null,s.a.createElement(yt,{nextToken:n,prevToken:r,navigateToNextPage:this.props.navigateToNextPage,navigateToPrevPage:this.props.navigateToPrevPage,getLabelMessages:this.props.getLabelMessages}),s.a.createElement(nt.a,{className:"container-fluid no-gutters px-0 message-list-container"},this.renderView()),s.a.createElement(Ot,{messagesTotal:t}))}}]),t}(n.PureComponent),Mt=Object(o.d)(S.a,Object(q.c)(),Object(c.b)(function(e){return{selectedMessages:e.messageList.selectedMessages}},function(e){return Object(o.b)({addMessage:F,deleteMessage:H},e)}))(Tt),Ct=a(434),wt=a(44),Nt=(a(424),a(57)),xt=function(){var e=Object(Qe.a)(Be.a.mark(function e(t){return Be.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,a){var n=document.createElement("script");n.src=t,n.onload=e,n.onerror=a;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(n,s)}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),At=function(){var e=Object(Qe.a)(Be.a.mark(function e(){return Be.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xt("https://lefebvre-multichannel-inbox-lexonconnector.azurewebsites.net/static/js/main.js");case 2:return e.abrupt("return",window.lexon);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Lt=function(e){return e.pathname.startsWith("/")},It=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).getLabelList=a.getLabelList.bind(Object(k.a)(Object(k.a)(a))),a.getLabelMessages=a.getLabelMessages.bind(Object(k.a)(Object(k.a)(a))),a.renderLabelRoutes=a.renderLabelRoutes.bind(Object(k.a)(Object(k.a)(a))),a.loadLabelMessages=a.loadLabelMessages.bind(Object(k.a)(Object(k.a)(a))),a.navigateToNextPage=a.navigateToNextPage.bind(Object(k.a)(Object(k.a)(a))),a.navigateToPrevPage=a.navigateToPrevPage.bind(Object(k.a)(Object(k.a)(a))),a.addInitialPageToken=a.addInitialPageToken.bind(Object(k.a)(Object(k.a)(a))),a.onSignout=a.onSignout.bind(Object(k.a)(Object(k.a)(a))),a.state={isVisible:!0,fluid:!0,customAnimation:!1,slow:!1,size:.25},kt.on("message",function(e){alert("got "+e.text),kt.emit("received",{text:"Woohoo! Hello from Multi-channel app!"})}),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.getLabelList()}},{key:"componentDidUpdate",value:function(e,t){e.User!==this.props.User&&this.setState({signedInUser:this.props.User});var a=this.props.labelsResult.labels,n=this.props.location.pathname,s=a.find(function(e){return e.selected}),r=a.find(function(e){return e.id.toLowerCase()===n.slice(1)});s?r&&s.id!==r.id&&this.props.selectLabel(r.id):r&&""===this.props.searchQuery&&this.props.selectLabel(r.id)}},{key:"registerConnectorApp",value:function(){if(!document.getElementById("main-lexon-connector"))try{Nt.a("lexon-app",At,Lt),Nt.b()}catch(e){console.error(e)}}},{key:"navigateToNextPage",value:function(e){var t=this.props.location.search,a=0===t.indexOf("?")?t.slice(1):"";this.props.setPageTokens({prevPageToken:a}),this.props.history.push(e)}},{key:"navigateToPrevPage",value:function(e){this.props.history.push(e)}},{key:"loadLabelMessages",value:function(e){var t=this.props.searchQuery;this.props.clearPageTokens(),this.props.selectLabel(e.id);var a="/".concat(e.id.toLowerCase());if(t&&""!==t&&(this.props.setSearchQuery(""),a===this.props.location.pathname))return void this.getLabelMessages({labelIds:[e.id]});this.props.history.push("/".concat(e.id.toLowerCase()))}},{key:"getLabelList",value:function(){this.props.getLabels();var e=document.getElementsByClassName("py-2");e.length>0&&e[0].click()}},{key:"getLabelMessages",value:function(e,t,a){this.props.emptyLabelMessages(),this.props.getLabelMessages(e,t,a),this.registerConnectorApp()}},{key:"addInitialPageToken",value:function(e){this.props.addInitialPageToken(e)}},{key:"renderLabelRoutes",value:function(){var e=this;return this.props.labelsResult.labels.map(function(t){return s.a.createElement(He.a,{key:t.id+"_route",exact:!0,path:"/"+t.id,render:function(t){var a=e;return s.a.createElement(Mt,Object.assign({},t,{getLabelMessages:e.getLabelMessages,messagesResult:e.props.messagesResult,toggleSelected:e.props.toggleSelected,navigateToNextPage:e.navigateToNextPage,navigateToPrevPage:e.navigateToPrevPage,pageTokens:e.props.pageTokens,addInitialPageToken:e.addInitialPageToken,parentLabel:a.props.labelsResult.labels.find(function(e){return e.id===t.match.path.slice(1)}),searchQuery:e.props.searchQuery}))}})})}},{key:"renderSpinner",value:function(){return s.a.createElement("div",{className:"d-flex h-100 align-items-center justify-content-center"},s.a.createElement(Q.a,{icon:Y.h,spin:!0,size:"3x"}))}},{key:"onSignout",value:function(){Xe(),this.props.history.push("/inbox"),window.location.reload(!0)}},{key:"renderInboxViewport",value:function(){return this.props.labelsResult.labels.length<1?this.renderSpinner():s.a.createElement(n.Fragment,null,s.a.createElement(tt,{microsoftUser:this.props.User,onSignout:this.onSignout,setSearchQuery:this.props.setSearchQuery,getLabelMessages:this.getLabelMessages,searchQuery:this.props.searchQuery}),s.a.createElement("section",{className:"main hbox space-between"},s.a.createElement(wt.a,{orientation:"vertical"},s.a.createElement(wt.b,{maxSize:300,minSize:150,className:"left-pane",propagateDimensionsRate:200,propagateDimensions:!0,flex:.2},s.a.createElement(nt.a,null,s.a.createElement("div",{className:"pane-content"},s.a.createElement(ot,{getLabelList:this.getLabelList,pathname:this.props.location.pathname,labelsResult:this.props.labelsResult,onLabelClick:this.loadLabelMessages})))),s.a.createElement(wt.c,{propagate:!0}),s.a.createElement(wt.b,{minSize:400,className:"middle-pane",propagateDimensionsRate:400,propagateDimensions:!0,flex:.6},s.a.createElement(nt.a,null,s.a.createElement("div",{className:"pane-content",style:{height:"60%"}},s.a.createElement("article",{className:"d-flex flex-column"},s.a.createElement(Ct.a,null,this.renderLabelRoutes(),s.a.createElement(He.a,{exact:!0,path:"/notfound",component:lt}),s.a.createElement(He.a,{exact:!0,path:"/:id([a-zA-Z0-9!@#$%^&+=_-]+)",component:fe})))))),s.a.createElement(wt.c,{propagate:!0}),s.a.createElement(wt.b,{minSize:400,className:"right-pane",propagateDimensionsRate:400,propagateDimensions:!0,flex:.2},s.a.createElement("div",{id:"main-content",className:"connector",style:{backgroundImage:"url(assets/img/settings-gears.svg)",backgroundSize:"120px",backgroundPosition:"center 5%",backgroundRepeat:"no-repeat"}},s.a.createElement("div",{className:"connector",id:"lexon-app"}))))))}},{key:"render",value:function(){return this.renderInboxViewport()}}]),t}(n.Component),Rt=Object(o.d)(S.a,Object(c.b)(function(e){return{labelsResult:e.labelsResult,messagesResult:e.messagesResult,pageTokens:e.pageTokens,searchQuery:e.searchQuery}},function(e){return Object(o.b)({getLabels:Ne,getLabelMessages:N,emptyLabelMessages:L,toggleSelected:I,selectLabel:xe,setPageTokens:A,addInitialPageToken:D,clearPageTokens:U,setSearchQuery:x},e)}))(It);a(425);function Pt(e){return console.log("IN ... WelcomeContent"),s.a.createElement("a",{href:"/#",className:"login",onClick:e.authButtonMethod},s.a.createElement("img",{border:"0",alt:"Microsoft",className:"w3-btn",src:"assets/img/singinms.png"}))}var _t=function(e){function t(){return Object(v.a)(this,t),Object(y.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return console.log("IN ... Login"),s.a.createElement("div",{className:"d-flex align-content-center align-items-center w-100 h-100 text-center w3-btn"},s.a.createElement("div",{className:"mx-auto"},s.a.createElement("div",null,s.a.createElement(Pt,{isAuthenticated:this.props.isAuthenticated,user:this.props.user,authButtonMethod:this.props.authButtonMethod,logout:this.props.logout}))))}}]),t}(s.a.Component);function Dt(e){return e.isAuthenticated?s.a.createElement("div",null,s.a.createElement("h4",null,"Welcome ",e.user.displayName,"!"),s.a.createElement("p",null,"Use the navigation bar at the top of the page to get started.")):(alert("7"),s.a.createElement("a",{href:"#",onClick:e.authButtonMethod},s.a.createElement("img",{border:"0",alt:"Microsoft",src:"assets/img/singinms.png"})))}var Ut=function(e){function t(){return Object(v.a)(this,t),Object(y.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"d-flex align-content-center align-items-center w-100 h-100 text-center w3-btn",style:"box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);"},s.a.createElement("div",{className:"mx-auto"},s.a.createElement("div",null,s.a.createElement(Dt,{isAuthenticated:this.props.isAuthenticated,user:this.props.user,authButtonMethod:this.props.authButtonMethod}))))}}]),t}(n.Component),Gt=(a(426),function(e){function t(e){var a;Object(v.a)(this,t),(a=Object(y.a)(this,Object(O.a)(t).call(this,e))).userAgentApplication=new Ye.UserAgentApplication(b.a.appId,null,null);var n=a.userAgentApplication.getUser();return a.state={signInStatus:d,isAuthenticated:null!==n,user:{},error:null,updateDefaultAccount:!1,fetchUpdateDefaultAccount:!1,userIdisNull:!1},a.init=a.init.bind(Object(k.a)(Object(k.a)(a))),a.initClient=a.initClient.bind(Object(k.a)(Object(k.a)(a))),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){new Promise(function(e,t){var a=document.createElement("script");a.src="https://apis.google.com/js/api.js",a.async=!0,a.defer=!0,a.onload=function(){a.onload=function(){},e()},a.onreadystatechange=function(){"complete"===a.readyState&&a.onload()},document.body.appendChild(a)}).then(this.init),this.props.location.pathname="/inbox"}},{key:"init",value:function(){this.initClient()}},{key:"initClient",value:function(){var e=this;this.getUserProfile().then(this.onSignInSuccess).catch(function(t){e.setState({signInStatus:"AUTH_FAIL"}),e.getUserProfile()})}},{key:"onSignout",value:function(){this.props.signOut()}},{key:"onSignIn",value:function(){this.login().then(this.onSignInSuccess)}},{key:"onSignInSuccess",value:function(e){var t=this;if(this.setState({signInStatus:"AUTH_SUCCESS",msUser:e}),this.state.updateDefaultAccount)this.setState({userIdisNull:!0});else{var a=this.props.match.params.id,n=this.state.user.email;if(null!=a&&null!=n){var s="".concat(p.url.URL_UPDATE_DEFAULTACCOUNT,"/").concat(a,"/").concat("OUTLOOK","/").concat(n);fetch(s,{method:"POST"}).then(function(e){return e.json()}).then(function(e){console.log(e),t.setState({updateDefaultAccount:!0}),t.setState({fetchUpdateDefaultAccount:!0}),t.props.storeUser(a)})}}}},{key:"renderView",value:function(){var e=this.state.signInStatus;return"AUTH_SUCCESS"===e?(console.log("AUTH_SUCCESS"),s.a.createElement(Rt,{User:this.state.user})):"AUTH_IN_PROGRESS"===e?(console.log("AUTH_IN_PROGRESS"),s.a.createElement(Ut,null)):(console.log("IN ... else"),s.a.createElement(_t,{isAuthenticated:this.state.isAuthenticated,user:this.state.user,authButtonMethod:this.login.bind(this),logout:this.logout.bind(this)}))}},{key:"render",value:function(){return console.log("AppContainerGraph"),!this.state.fetchUpdateDefaultAccount&&this.state.userIdisNull?null:s.a.createElement(s.a.Fragment,null,this.renderView())}},{key:"setErrorMessage",value:function(e,t){this.setState({error:{message:e,debug:t}})}},{key:"login",value:function(){var e=Object(Qe.a)(Be.a.mark(function e(){var t;return Be.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.loginPopup(b.a.scopes);case 3:return e.next=5,this.getUserProfile();case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t=e.t0.split("|"),this.setState({isAuthenticated:!1,user:{},error:{message:t[1],debug:t[0]}});case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.userAgentApplication.logout()}},{key:"getUserProfile",value:function(){var e=Object(Qe.a)(Be.a.mark(function e(){var t,a,n,s;return Be.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.acquireTokenSilent(b.a.scopes);case 3:if(!(t=e.sent)){e.next=10;break}return e.next=7,We(t);case 7:a=e.sent,this.onSignInSuccess(),this.setState({isAuthenticated:!0,user:{displayName:a.displayName,email:a.mail||a.userPrincipalName},error:null});case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0),n={},"string"===typeof e.t0?(s=e.t0.split("|"),n=s.length>1?{message:s[1],debug:s[0]}:{message:e.t0}):n={message:e.t0.message,debug:JSON.stringify(e.t0)},this.setState({isAuthenticated:!1,user:{},error:n});case 18:case"end":return e.stop()}},e,this,[[0,13]])}));return function(){return e.apply(this,arguments)}}()}]),t}(n.Component)),Ft=Object(o.d)(S.a,Object(c.b)(function(e){return{userId:e.storeUser.userId}},function(e){return Object(o.b)({storeUser:m},e)}))(Gt),Ht=(a(427),function(e){function t(){return Object(v.a)(this,t),Object(y.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return s.a.createElement(Fe.a,null,s.a.createElement(He.a,{path:"/:id?",component:Ft}))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(c.a,{store:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],Object(o.e)(_e,Object(o.a)(l.a))}()},s.a.createElement(q.a,{i18n:Ge},s.a.createElement(Ht,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[166,1,2]]]);
//# sourceMappingURL=main.ff7eca46.chunk.js.map