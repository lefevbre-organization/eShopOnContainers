(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{152:function(e,t,a){},153:function(e,t,a){e.exports=a(429)},170:function(e,t,a){},171:function(e,t,a){},272:function(e,t,a){},385:function(e,t,a){},387:function(e,t,a){},388:function(e,t,a){},389:function(e,t,a){},390:function(e,t,a){},391:function(e,t,a){},421:function(e,t,a){},422:function(e,t,a){},428:function(e,t,a){},429:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(17),i=a.n(r),c=a(19),l=a(14),o=a(140),u=a(4),d="SIGNED_OUT",p={url:{URL_UPDATE_DEFAULTACCOUNT:"https://lefebvreservernode.azurewebsites.net/api/accounts/defaultaccount",URL_RESET_DEFAULTACCOUNT:"https://lefebvreservernode.azurewebsites.net/api/accounts/resetdefaultaccount",URL_SELECT_ACCOUNT:"https://Lefebvrerootapp"}},m=function(e){return function(t){t({type:"STORE_USER",userId:e})}},g={userId:""},h=function(e,t){var a="";return a=(a="undefined"===typeof e.parts?e.body.data:b(e.parts,t)).replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,""),decodeURIComponent(escape(window.atob(a)))},b=function e(t,a){for(var n=0;n<t.length;n++){if("undefined"!==typeof t[n].parts)return e(t[n].parts,a);if(t[n].mimeType===a)return t[n].body.data}return""},f=function(e){var t=null;if("string"!==typeof e)return t;var a=e.match(/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,.*/);return a&&a.length&&(t=a[1]),t},v=function(e){return new Promise(function(t,a){var n=e.result.labels.map(function(e){return t=e.id,new Promise(function(e,a){window.gapi.client.gmail.users.labels.get({userId:"me",id:t}).then(function(t){return e(t)})});var t});Promise.all(n).then(function(e){return t(e)})})},E=function(e,t){return new Promise(function(a,n){t?window.gapi.client.gmail.users.labels.get({userId:"me",id:t[0]}).then(function(t){return a({messages:e,label:t})}):a({messages:e,label:{result:{messagesTotal:0}}})})},y=function(e){var t=e.labelIds,a=e.maxResults,n=e.pageToken,s=e.q,r=void 0===s?"":s;return new Promise(function(e,s){window.gapi.client.gmail.users.messages.list(Object(u.a)({userId:"me",q:r,maxResults:a||20},t&&{labelIds:t},n&&{pageToken:n})).then(function(t){return e(t)}).catch(function(e){s(e)})})},O=function(e){var t=e.result;return new Promise(function(e,a){var n=(t.messages||[]).map(function(e){return j(e.id)});Promise.all(n).then(function(a){return e(Object(u.a)({},t,{messages:a}))})})},j=function(e){return new Promise(function(t,a){window.gapi.client.gmail.users.messages.get({userId:"me",id:e,format:"metadata",metadataHeaders:["Delivered-To","X-Received","To","Message-ID","Date","Content-Type","MIME-Version","Reply-To","From","Subject","Return-Path"]}).then(function(e){return t(e.result)})})},k=function(e){return new Promise(function(t,a){window.gapi.client.gmail.users.messages.get({userId:"me",id:e,format:"full"}).then(function(e){var a=e.result,n=h(a.payload,"text/html"),s=a.payload.parts;""===n&&(n=(n=h(a.payload,"text/plain")).replace(/(\r\n)+/g,'<br data-break="rn-1">').replace(/[\n\r]+/g,'<br data-break="nr">')),""===n||function(e){var t=(new DOMParser).parseFromString(e,"text/html");return Array.from(t.body.childNodes).some(function(e){return 1===e.nodeType})}(n)||(n=n.replace(/(\r\n)+/g,'<div data-break="rn-1" style="margin-bottom:10px"></div>').replace(/[\n\r]+/g,'<br data-break="nr">')),t({body:n,attach:s,headers:e.headers,result:Object(u.a)({},a,{messageHeaders:e.result.payload.headers,payload:void 0})})}).catch(function(e){a(e)})})};var S="ADD_MESSAGE",M="DELETE_MESSAGE",T="DELETE_LIST_MESSAGES",C="ADD_LIST_MESSAGES",I=function(e){var t=e.labelIds,a=(e.q,e.pageToken);return function(e,n){e(R());var s=n().searchQuery;""!==s&&e(Q("-1")),function(e){var t=e.labelIds,a=e.maxResults,n=e.q,s=e.pageToken;return new Promise(function(e,r){y({labelIds:t,maxResults:a,pageToken:s,q:n}).then(O).then(function(a){return E(a.messages,t).then(function(t){return e(Object(u.a)({},a,{messages:t.messages,label:t.label}))})}).catch(function(e){r(e)})})}({labelIds:t,maxResults:20,q:s,pageToken:a}).then(function(t){e({type:"GET_MESSAGES",payload:t}),e(L({nextPageToken:t.nextPageToken||""}))}).catch(function(t){e({type:"GET_MESSAGES_FAILED",payload:t})})}},w=function(e){return{type:"SET_SEARCH_QUERY",payload:e}},L=function(e){return{type:"SET_PAGE_TOKENS",payload:e}},x=function(){return{type:"EMPTY_MESSAGES"}},N=function(e,t){return{type:"TOGGLE_SELECTED",payload:{messageIds:e,selected:t}}},A=function(e){return function(t){t(P()),k(e).then(function(e){t({type:"MESSAGE_LOAD_SUCCESS",payload:e})}).catch(function(e){t({type:"MESSAGE_LOAD_FAIL",payload:e})})}},P=function(){return{type:"MESSAGE_LOAD_IN_PROGRESS"}},R=function(){return{type:"GET_MESSAGES_LOAD_IN_PROGRESS"}},_=function(e){return{type:"ADD_INITIAL_PAGE_TOKEN",payload:e}},D=function(){return{type:"CLEAR_PAGE_TOKENS"}},U=function(e){var t=e.ids,a=e.addLabelIds,n=void 0===a?[]:a,s=e.removeLabelIds,r=void 0===s?[]:s;return function(e){(function(e){var t=e.ids,a=e.addLabelIds,n=void 0===a?[]:a,s=e.removeLabelIds,r=void 0===s?[]:s;return new Promise(function(e,a){window.gapi.client.gmail.users.messages.batchModify({userId:"me",ids:t,addLabelIds:n,removeLabelIds:r}).then(function(a){e(t)})})})({ids:t,addLabelIds:n,removeLabelIds:r}).then(function(t){e({type:"MODIFY_MESSAGES_SUCCESS",payload:{modifiedIds:t,addLabelIds:n,removeLabelIds:r}})}).catch(function(t){e({type:"MODIFY_MESSAGES_FAILED"})})}},G=function(e){return function(t){t({type:S,data:{id:e,content:e}})}},F=function(e){return function(t){t({type:M,data:{id:e,content:e}})}},H=function(e){return function(t){t({type:T,listMessages:e})}},z=function(e){return function(t){t({type:C,listMessages:e})}},Y=function(){return function(e){new Promise(function(e,t){window.gapi.client.gmail.users.labels.list({userId:"me"}).then(v).then(function(t){e(t.map(function(e){return e.result}))})}).then(function(t){e({type:"GET_LABELS",payload:t})})}},Q=function(e){return function(t){t({type:"SELECT_LABEL",payload:e})}},V={labels:[]},B=a(151),q=a(18),K={messages:[],loading:!0,pageTokens:[]},W={body:"",loading:!1,failed:!1},Z={selectedMessages:[]};var X="ADD_MESSAGE",J="DELETE_MESSAGE",$="DELETE_LIST_MESSAGES",ee="ADD_LIST_MESSAGES",te=function(e){return function(t){t({type:X,data:{id:e,content:e}})}},ae=function(e){return function(t){t({type:J,data:{id:e,content:e}})}},ne=function(e){return function(t){t({type:$,listMessages:e})}},se=function(e){return function(t){t({type:ee,listMessages:e})}},re={selectedMessages:[]};var ie=Object(l.c)({signedOutReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch((arguments.length>1?arguments[1]:void 0).type){case d:return{};default:return e}},signInStatusResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_IN_PROGRESS":return Object(u.a)({},e,{status:"AUTH_IN_PROGRESS"});case"AUTH_SUCCESS":return Object(u.a)({},e,{status:"AUTH_SUCCESS",currentUser:t.payload.currentUser});case"AUTH_FAIL":return Object(u.a)({},e,{status:"AUTH_FAIL"});case"SIGNED_IN":return Object(u.a)({},t.payload);case d:return Object(u.a)({},e,{status:"AUTH_SIGNED_OUT",currentUser:{}});default:return e}},storeUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STORE_USER":return Object(u.a)({},e,{userId:t.userId});default:return e}},labelsResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_LABELS":return console.log(t.payload),Object(u.a)({},e,{labels:t.payload});case"SELECT_LABEL":return Object(u.a)({},e,{labels:e.labels.map(function(e){return e.id===t.payload?Object(u.a)({},e,{selected:!0}):Object(u.a)({},e,{selected:!1})})});default:return e}},messagesResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_MESSAGES":var a=Object(u.a)({},e);a.nextPageToken=null;var n=Object(q.a)(a.pageTokens),s=t.payload.nextPageToken;return s&&-1===n.indexOf(s)&&n.push(s),Object(u.a)({},a,t.payload,{loading:!1,pageTokens:n});case"GET_MESSAGES_FAILED":return Object(u.a)({},e,{loading:!1,failed:!0,error:t.payload});case"EMPTY_MESSAGES":return Object(u.a)({},e,{messages:[]});case"GET_MESSAGES_LOAD_IN_PROGRESS":return Object(u.a)({},e,{label:null,nextPageToken:null,loading:!0});case"TOGGLE_SELECTED":return Object(u.a)({},e,{messages:e.messages.map(function(e){return t.payload.messageIds.indexOf(e.id)>-1?Object(u.a)({},e,{selected:t.payload.selected}):e})});case"ADD_INITIAL_PAGE_TOKEN":return Object(u.a)({},e,{pageTokens:[t.payload]});case"CLEAR_PAGE_TOKENS":return Object(u.a)({},e,{pageTokens:[]});case"MODIFY_MESSAGES_SUCCESS":return Object(u.a)({},e,{messages:e.messages.filter(function(e){return-1===t.payload.modifiedIds.indexOf(e.id)})});default:return e}},emailMessageResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_MESSAGES_LOAD_IN_PROGRESS":case"MESSAGE_LOAD_IN_PROGRESS":return Object(u.a)({},e,{body:"",loading:!0,failed:!1});case"MESSAGE_LOAD_SUCCESS":var a=t.payload;return a.body,Object(B.a)(a,["body"]),Object(u.a)({},e,t.payload,{loading:!1,failed:!1});case"MESSAGE_LOAD_FAIL":return Object(u.a)({},e,{loading:!1,failed:!0,error:t.payload});default:return e}},pageTokens:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{prevPageToken:"",nextPageToken:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PAGE_TOKENS":return Object(u.a)({},e,t.payload);default:return e}},searchQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SEARCH_QUERY":return t.payload;default:return e}},messageList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return-1===e.selectedMessages.findIndex(function(e){return e.id===t.data.id})?Object(u.a)({},e,{selectedMessages:[].concat(Object(q.a)(e.selectedMessages),[t.data])}):e;case M:return Object(u.a)({},e,{selectedMessages:e.selectedMessages.filter(function(e){return e.id!==t.data.id})});case T:for(var a=function(a){var n=e.selectedMessages.findIndex(function(e){return e.id===t.listMessages[a]});n>-1&&e.selectedMessages.splice(n,1)},n=0;n<t.listMessages.length;n++)a(n);return Object(u.a)({},e,{selectedMessages:e.selectedMessages});case C:var s=function(a){if(-1===e.selectedMessages.findIndex(function(e){return e.id===t.listMessages[a]})){var n={id:t.listMessages[a],content:t.listMessages[a]};e.selectedMessages.push(n)}};for(n=0;n<t.listMessages.length;n++)s(n);return Object(u.a)({},e,{selectedMessages:e.selectedMessages});default:return e}},lexonMessageListReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X:return-1===e.selectedMessages.findIndex(function(e){return e.id===t.data.id})?Object(u.a)({},e,{selectedMessages:[].concat(Object(q.a)(e.selectedMessages),[t.data])}):e;case J:return Object(u.a)({},e,{selectedMessages:e.selectedMessages.filter(function(e){return e.id!==t.data.id})});case $:for(var a=function(a){var n=e.selectedMessages.findIndex(function(e){return e.id===t.listMessages[a]});n>-1&&e.selectedMessages.splice(n,1)},n=0;n<t.listMessages.length;n++)a(n);return Object(u.a)({},e,{selectedMessages:e.selectedMessages});case ee:var s=function(a){if(-1===e.selectedMessages.findIndex(function(e){return e.id===t.listMessages[a]})){var n={id:t.listMessages[a],content:t.listMessages[a]};e.selectedMessages.push(n)}};for(n=0;n<t.listMessages.length;n++)s(n);return Object(u.a)({},e,{selectedMessages:e.selectedMessages});default:return e}}});var ce=a(23),le=a(91),oe=a(144);le.a.use(oe.a).init({lng:navigator.language,fallbackLng:"en",ns:["isotope"],defaultNS:"isotope",backend:{loadPath:"/assets/locales/{{lng}}/{{ns}}.json"},interpolation:{escapeValue:!1},react:{wait:!1,withRef:!1,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default",useSuspense:!1}});var ue=le.a,de=(a(170),a(6)),pe=a(5),me=a(9),ge=a(7),he=a(8),be=a(434),fe=a(432),ve=a(2),Ee=a(436),ye=(a(171),a(16)),Oe=a(13),je=a(431),ke=a(145),Se=a.n(ke),Me=a(10),Te=function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).handleInputChange=a.handleInputChange.bind(Object(ve.a)(Object(ve.a)(a))),a.handleSearchClick=a.handleSearchClick.bind(Object(ve.a)(Object(ve.a)(a))),a._handleOnClick=a._handleOnClick.bind(Object(ve.a)(Object(ve.a)(a))),a.performSearch=Se()(a.performSearch.bind(Object(ve.a)(Object(ve.a)(a))),1e3),a.toggle=a.toggle.bind(Object(ve.a)(Object(ve.a)(a))),a.toggleMenu=a.toggleMenu.bind(Object(ve.a)(Object(ve.a)(a))),a.state={dropdownOpen:!1,dropdownMenuOpen:!1},a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"_handleOnClick",value:function(e){var t=this.props.userId;if(""!==t&&void 0!==t){var a="".concat(p.url.URL_RESET_DEFAULTACCOUNT,"/").concat(t);fetch(a,{method:"POST"}).then(function(e){return e.json()}).then(function(e){console.log(e);var a="".concat(p.url.URL_SELECT_ACCOUNT,"/user/").concat(t,"/encrypt/0");window.open(a,"_self")})}else{var n="".concat(p.url.URL_SELECT_ACCOUNT,"/user");window.open(n,"_self")}}},{key:"toggle",value:function(){this.setState({dropdownOpen:!this.state.dropdownOpen})}},{key:"toggleMenu",value:function(){this.setState({dropdownMenuOpen:!this.state.dropdownMenuOpen})}},{key:"handleSearchClick",value:function(e){""!==this.props.searhQuery&&this.performSearch()}},{key:"handleInputChange",value:function(e){this.props.setSearchQuery(e.target.value),this.performSearch()}},{key:"performSearch",value:function(){var e={};this.props.searchQuery&&""!==this.props.searchQuery||(e.labelIds=["INBOX"]),this.props.getLabelMessages(Object(u.a)({},e))}},{key:"render",value:function(){var e=this.props.googleUser.w3,t=e.U3,a=e.ig,n=e.Paa;return s.a.createElement("header",{className:"d-flex p-3 align-content-center align-items-center header "},s.a.createElement("div",{className:"justify-content-left"},s.a.createElement(je.a,{to:"/inbox"},s.a.createElement("img",{border:"0",alt:"lefebvre",src:"assets/img/lefebvre-logo.png"}))),s.a.createElement("div",{className:"header-logo justify-content-center"},s.a.createElement(je.a,{to:"/inbox"},s.a.createElement("img",{className:"logo-ext",border:"0",alt:"otulook",src:"assets/img/gmail.png"}))),s.a.createElement("div",{className:"header-search"},s.a.createElement("div",{className:"input-group w-75 ml-1 mr-auto"},s.a.createElement("input",{type:"search",className:"form-control search",placeholder:"Search mail",value:this.props.searchQuery,onChange:this.handleInputChange}),s.a.createElement("div",{className:"input-group-append",onClick:this.handleSearchClick},s.a.createElement("button",{className:"btn btn-light  bg-white text-dark btn-search",type:"button"},s.a.createElement(ye.a,{icon:Oe.j})))),s.a.createElement("div",null,s.a.createElement(Me.m,{className:"ml-auto",navbar:!0},s.a.createElement(Me.n,{className:"d-md-down-none"},s.a.createElement(Me.o,{href:"#"},s.a.createElement("i",{className:"icon-location-pin"}))),s.a.createElement(Me.b,{nav:!0,isOpen:this.state.dropdownMenuOpen,toggle:this.toggleMenu},s.a.createElement(Me.e,{nav:!0},s.a.createElement("img",{className:"img-menu",src:"assets/img/menu.png",alt:""})),s.a.createElement(Me.d,{right:!0},s.a.createElement(Me.c,null,s.a.createElement("i",{className:"fa fa-shield"})," Calendar"),s.a.createElement(Me.c,null,s.a.createElement("i",{className:"fa fa-shield"})," File Manager"),s.a.createElement(Me.c,{divider:!0}),s.a.createElement(Me.c,null,s.a.createElement("i",{className:"fa fa-lock"}),s.a.createElement("span",{onClick:this._handleOnClick}," Return to Lex-on")))))),s.a.createElement("div",null,s.a.createElement(Me.m,{className:"ml-auto",navbar:!0},s.a.createElement(Me.n,{className:"d-md-down-none"},s.a.createElement(Me.o,{href:"#"},s.a.createElement("i",{className:"icon-location-pin"}))),s.a.createElement(Me.b,{nav:!0,isOpen:this.state.dropdownOpen,toggle:this.toggle},s.a.createElement(Me.e,{nav:!0},s.a.createElement("img",{className:"mx-2 profile-pic img-circle",src:n,alt:""})),s.a.createElement(Me.d,{right:!0},s.a.createElement(Me.c,{header:!0,tag:"div",className:"text-center"},s.a.createElement("strong",{title:t},a)),s.a.createElement(Me.c,{divider:!0}),s.a.createElement(Me.c,null,s.a.createElement("i",{className:"fa fa-shield"})," Add Account"),s.a.createElement(Me.c,null,s.a.createElement("i",{className:"fa fa-shield"})," Create Account"),s.a.createElement(Me.c,{divider:!0}),s.a.createElement(Me.c,{onClick:this.props.onSignout},s.a.createElement("i",{className:"fa fa-lock"})," Logout")))))))}}]),t}(n.PureComponent),Ce=Object(c.b)(function(e){return{userId:e.storeUser.userId}},function(e){return Object(l.b)({storeUser:m},e)})(Te),Ie=a(44),we=function(e){var t=[];if(!e||""===e.trim())return t;for(var a=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,n=e.trim().replace(/[;\s]/g,",").split(","),s=0;s<n.length;s++){var r=n[s];if(""!==r){if(!a.test(r)){t=[];break}t.push(r)}}return t},Le=function(e){if(!e)return null;var t,a,n;return null!==(t=/(?:"?([^"]*)"?\s)?(?:<?(.+@[^>]+)>?)/.exec(e))&&(n=t[2],a=t[1]||n.slice(0,n.indexOf("@"))),{name:a,email:n}},xe=a(147),Ne=a.n(xe),Ae=(a(271),a(272),a(31)),Pe=a(288),Re=a(311),_e=a(329),De=(_e.Dashboard,_e.DashboardModal,_e.DragDrop),Ue=_e.ProgressBar,Ge=function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).state={displayModal:!1,to:e.to||"",cc:e.cc||"",bcc:e.bcc||"",subject:e.subject||"",content:e.content||"",showInlineDashboard:!1,open:!1,uppyPreviews:[]},a.showModal=a.showModal.bind(Object(ve.a)(Object(ve.a)(a))),a.closeModal=a.closeModal.bind(Object(ve.a)(Object(ve.a)(a))),a.handleChange=a.handleChange.bind(Object(ve.a)(Object(ve.a)(a))),a.sendEmail=a.sendEmail.bind(Object(ve.a)(Object(ve.a)(a))),a.setField=a.setField.bind(Object(ve.a)(Object(ve.a)(a))),a.uppy=new Ae({id:"uppy1",autoProceed:!1,debug:!0}).use(Pe,{endpoint:"https://master.tus.io/files/"}).use(Re,{serverUrl:"https://companion.uppy.io"}),a.reader=new FileReader,a.handleModalClick=a.handleModalClick.bind(Object(ve.a)(Object(ve.a)(a))),a.uploadFile=a.uploadFile.bind(Object(ve.a)(Object(ve.a)(a))),a.addFileToState=a.addFileToState.bind(Object(ve.a)(Object(ve.a)(a))),a.uppy.on("complete",function(e){console.log("Upload complete! We\ufffdve uploaded these files:",e.successful)}),a.uppy.on("file-added",function(e){console.log("Added file",e),a.reader.onload=function(t){return a.addFileToState({file:e,base64:t.target.result})},a.reader.readAsDataURL(e.data)}),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"addFileToState",value:function(e){var t=e.file,a=e.base64;this.setState({uppyPreviews:[{file:t,base64:a}].concat(Object(q.a)(this.state.uppyPreviews))})}},{key:"uploadFile",value:function(){console.log(this.state.uppyPreviews)}},{key:"componentWillUnmount",value:function(){this.uppy.close()}},{key:"handleModalClick",value:function(){this.setState({open:!this.state.open})}},{key:"showModal",value:function(){this.setState({displayModal:!0})}},{key:"closeModal",value:function(){this.setState({displayModal:!1}),this.uppy.close(),this.state.uppyPreviews=[],this.uppy.reset()}},{key:"handleChange",value:function(e){this.setState({content:e})}},{key:"sendEmail",value:function(){var e=this,t=we(this.state.to);if(t.length&&""!==this.state.subject.trim()&&""!==this.state.content){var a={To:t.join(", "),Subject:this.state.subject,attachments:this.state.uppyPreviews},n=we(this.state.cc);n.length&&(a.Cc=n.join(", "));var s=we(this.state.bcc);s.length&&(a.Bcc=s.join(", "));var r=this.state.uppyPreviews;(function(e){var t,a=e.headers,n=e.body,s=(e.attachments,""),r=Object(u.a)({},a);for(var i in r["MIME-Version"]="1.0",r["Content-Type"]="multipart/mixed; boundary=alternative",r)s+="".concat(i,": ").concat(r[i],"\r\n");s+="\r\n",s+="--alternative\r\n",s+='Content-Type: multipart/alternative; boundary = "attached"\r\n',s+="\r\n",s+="--attached\r\n",s+='Content-Type: text/plain; charset = "iso-8859-1"\r\n',s+="Content-Transfer-Encoding: quoted-printable\r\n",s+="\r\n",s+="".concat(n,"\r\n"),s+="\r\n",s+="--attached\r\n",s+='Content-Type: text/html; charset = "iso-8859-1"\r\n',s+="Content-Transfer-Encoding: quoted-printable\r\n",s+="\r\n",s+="\r\n<html><head></head><body>".concat(n,"</body></html>\r\n"),s+="\r\n",s+="--attached--\r\n";for(var c=0;c<r.attachments.length;c++){var l=f(r.attachments[c].base64),o="string"!==typeof(t=r.attachments[c].base64)?null:t.split("base64,")[1],d=r.attachments[c].file.name;console.log(l),console.log(o),s+="--alternative\r\n",s+="Content-Type: ".concat(l,"\r\n"),s+="Content-Transfer-Encoding: base64\r\n",s+='Content-Disposition: attachment; filename = "'.concat(d,'"\r\n'),s+="".concat(o,"\r\n")}s+="--alternative--\r\n";var p=unescape(encodeURIComponent(s));return window.gapi.client.gmail.users.messages.send({userId:"me",resource:{raw:window.btoa(p).replace(/\+/g,"-").replace(/\//g,"_")}})})({headers:a,body:this.state.content,attachments:r}).then(function(t){e.closeModal(),e.resetFields()}),this.closeModal()}}},{key:"resetFields",value:function(){this.setState({to:this.props.to||"",cc:this.props.cc||"",bcc:this.props.bcc||"",subject:this.props.subject||"",content:this.props.content||"",uppyPreviews:[]})}},{key:"setField",value:function(e){var t=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(n){t.setState(Object(Ie.a)({},e,a?n.target.value.trim():n.target.value))}}},{key:"isInvalid",value:function(e){var t=this.state[e].trim();return t.length>0&&!we(t).length}},{key:"render",value:function(){this.state.showInlineDashboard;var e=this.props.t;return s.a.createElement(s.a.Fragment,null,s.a.cloneElement(this.props.children,{onClick:this.showModal}),this.state.displayModal?s.a.createElement(Me.i,{isOpen:this.state.displayModal,className:"compose-dialog",size:"lg","overflow-y":"initial !important",onOpened:this.onModalOpened,backdrop:"static",centered:!0},s.a.createElement(Me.l,{toggle:this.closeModal},e("compose-message.compose-message")),s.a.createElement(Me.j,null,s.a.createElement("div",{className:"message-fields"},s.a.createElement(Me.g,null,s.a.createElement(Me.h,{addonType:"prepend"},e("compose-message.to")),s.a.createElement(Me.f,{tabIndex:1,value:this.state.to,placeholder:e("compose-message.comma-separated"),invalid:this.isInvalid("to"),onChange:this.setField("to")})),s.a.createElement(Me.g,null,s.a.createElement(Me.h,{addonType:"prepend"},"Cc:"),s.a.createElement(Me.f,{tabIndex:2,value:this.state.cc,placeholder:e("compose-message.comma-separated"),invalid:this.isInvalid("cc"),onChange:this.setField("cc")})),s.a.createElement(Me.g,null,s.a.createElement(Me.h,{addonType:"prepend"},"Bcc:"),s.a.createElement(Me.f,{tabIndex:3,placeholder:e("compose-message.comma-separated"),invalid:this.isInvalid("bcc"),onChange:this.setField("bcc")})),s.a.createElement(Me.g,null,s.a.createElement(Me.h,{addonType:"prepend"},e("compose-message.subject")),s.a.createElement(Me.f,{tabIndex:4,placeholder:"",value:this.state.subject,onChange:this.setField("subject",!1)}))),s.a.createElement("div",{className:"editor-wrapper"},s.a.createElement(Ne.a,{tabIndex:5,value:this.state.content,onChange:this.handleChange}))),s.a.createElement(Me.k,{className:"footer"},s.a.createElement(Me.a,{className:"mr-auto font-weight-bold",size:"lg",color:"primary",onClick:this.sendEmail,title:e("compose-message.send-message")},e("compose-message.send"))," ",s.a.createElement(Me.a,{title:e("compose-message.discard"),color:"light",onClick:this.closeModal},s.a.createElement(ye.a,{icon:Oe.l}))),s.a.createElement("div",{className:"ImagePreviewContainer"},this.state.uppyPreviews.map(function(e){return s.a.createElement("object",{className:"FileList",key:e.file.id,type:e.file.type,width:"80px",height:"auto",data:e.base64},e.file.name)})),s.a.createElement(Ue,{uppy:this.uppy,hideAfterFinish:!1}),s.a.createElement("div",{id:"Divfooter"},s.a.createElement(De,{uppy:this.uppy,width:"100%",height:"130px","min-height":"130px"}))):null)}}]),t}(n.PureComponent),Fe=Object(ce.c)()(Ge),He=a(39),ze=a.n(He),Ye=a(148),Qe=a.n(Ye),Ve=a(149),Be=a.n(Ve),qe=function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).onClick=a.onClick.bind(Object(ve.a)(Object(ve.a)(a))),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"onClick",value:function(e){this.props.onClick(e,this.props.id)}},{key:"render",value:function(){var e=this.props,t=e.name,a=e.messagesUnread,n=this.props.iconProps,r=this.props.selected?" selected":"",i=a.toLocaleString();return s.a.createElement("li",{className:"text-truncate text-left text-dark pl-4 pr-5 py-2 border-0 ".concat(r),title:t+(a>0?" (".concat(i,")"):""),onClick:this.onClick},s.a.createElement(ye.a,Object.assign({size:"sm"},n)),t,a>0?s.a.createElement("div",{className:"msg-count"},i):null)}}]),t}(n.PureComponent),Ke=(a(385),function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).state={selectedLabel:e.pathname},a.navigateToList=a.navigateToList.bind(Object(ve.a)(Object(ve.a)(a))),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"componentDidMount",value:function(){}},{key:"navigateToList",value:function(e,t){var a=this.props.labelsResult.labels.find(function(e){return e.id===t});this.props.onLabelClick(a||{id:""})}},{key:"renderItems",value:function(e){if(0===e.length)return s.a.createElement("div",null);var t=e.reduce(function(e,t){return e.push(t),e},[]),a=Qe()(t,"type"),n=[],r=[];return null!=a.user&&(n=a.user.filter(function(e){return!e.labelListVisibility||!0}),r=Be()(n,"name")),s.a.createElement(s.a.Fragment,null,this.renderFolders(a.system),this.renderLabels(r))}},{key:"renderFolders",value:function(e){var t=this,a=this.props.t,n=[Object(u.a)({},e.find(function(e){return"INBOX"===e.id}),{name:a("sidebar.inbox"),icon:Oe.g}),Object(u.a)({},e.find(function(e){return"SENT"===e.id}),{messagesUnread:0,name:a("sidebar.sent"),icon:Oe.d}),Object(u.a)({},e.find(function(e){return"TRASH"===e.id}),{messagesUnread:0,name:a("sidebar.trash"),icon:Oe.l}),Object(u.a)({},e.find(function(e){return"SPAM"===e.id}),{name:a("sidebar.spam"),icon:Oe.e})];return s.a.createElement(s.a.Fragment,null,s.a.createElement("li",{key:"olders-nav-title",className:"pl-2 nav-title"},a("sidebar.folders")),n.map(function(e){var a={icon:e.icon,size:"lg"};return s.a.createElement(qe,{key:e.id+"_label",onClick:t.navigateToList,name:e.name,id:e.id,messagesUnread:e.messagesUnread,iconProps:a,selected:e.selected})}))}},{key:"renderLabels",value:function(e){var t=this,a=this.props.t;return s.a.createElement(s.a.Fragment,null,s.a.createElement("li",{key:"olders-nav-title",className:"pl-2 nav-title"},a("sidebar.labels")),e.map(function(e){var a={icon:Oe.c,color:e.color?e.color.backgroundColor:"gainsboro",size:"sm"};return s.a.createElement(qe,{key:e.id+"_label",onClick:t.navigateToList,name:e.name,id:e.id,messagesUnread:e.messagesUnread,iconProps:a,selected:e.selected})}))}},{key:"render",value:function(){var e=this.props.t;return s.a.createElement("nav",{className:"d-flex flex-column text-truncate left-panel"},s.a.createElement("div",{className:"compose-panel"},s.a.createElement("div",{className:"d-flex justify-content-center p-2 compose-btn"},s.a.createElement(Fe,{subject:"",to:""},s.a.createElement("button",{className:"btn btn btn-outline-secondary uppercase align-self-center w-75 font-weight-bold uppercase"},e("sidebar.compose"))))),s.a.createElement(ze.a,{component:"ul",className:"d-flex flex-column border-0 m-0 sidebar"},this.renderItems(this.props.labelsResult.labels)))}}]),t}(n.PureComponent)),We=Object(ce.c)()(Ke),Ze=(a(152),function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).toggleClock=function(){a.timerID?(clearInterval(a.timerID),a.timerID=void 0,a.setState(function(){return{running:!1}})):(a.setState(function(){return{running:!0}}),a.timerID=setInterval(function(){return a.tick()},1e3))},a.state={running:!0,date:new Date,message:"Seleccione elemento/s de la lista"},a.handleEnter=a.handleEnter.bind(Object(ve.a)(Object(ve.a)(a))),a.handleKeyPress=a.handleKeyPress.bind(Object(ve.a)(Object(ve.a)(a))),a.handleCheckAllclick=a.handleCheckAllclick.bind(Object(ve.a)(Object(ve.a)(a))),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"sendMessage",value:function(){window.dispatchEvent(new CustomEvent("toggleClock",{detail:{name:"John"}}))}},{key:"componentDidMount",value:function(){var e=this;this.timerID=setInterval(function(){return e.tick()},1e3),window.addEventListener("Checkclick",this.handleKeyPress),window.addEventListener("CheckAllclick",this.handleCheckAllclick)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID),window.removeEventListener("Checkclick",this.handleKeyPress),window.removeEventListener("CheckAllclick",this.handleCheckAllclick)}},{key:"tick",value:function(){this.setState(function(){return{date:new Date}})}},{key:"handleKeyPress",value:function(e){this.setState({message:e.detail.name+" Selected: "+e.detail.chkselected}),e.detail.chkselected?this.props.addMessage(e.detail.name):this.props.deleteMessage(e.detail.name),this.handleEnter(e)}},{key:"handleEnter",value:function(e){this.setState({message:e.detail.name+" Selected: "+e.detail.chkselected})}},{key:"handleCheckAllclick",value:function(e){e.detail.chkselected?this.props.addListMessages(e.detail.listMessages):this.props.deleteListMessages(e.detail.listMessages)}},{key:"render",value:function(){var e=this.state.running?"clock--running":"clock--paused";return s.a.createElement("div",{id:"main-lexon-connector",className:"clock ".concat(e)},s.a.createElement("h1",null,"LEX-ON Connector DEV mode!!!"),s.a.createElement("h2",{className:"clock__time"},"It is ",this.state.date.toLocaleTimeString()),s.a.createElement("p",null),s.a.createElement("p",null,this.state.message),s.a.createElement("h1",null,"Lista de Mensajes"),this.props.selectedMessages.map(function(e){return s.a.createElement("div",{key:e.id},e.content)}))}}]),t}(n.Component)),Xe=Object(l.d)(Ee.a,Object(c.b)(function(e){return{selectedMessages:e.lexonMessageListReducer.selectedMessages}},function(e){return Object(l.b)({addMessage:te,deleteMessage:ae,deleteListMessages:ne,addListMessages:se},e)}))(Ze),Je=function(){return s.a.createElement("div",{className:"d-flex w-100 h-100 flex-column justify-content-center align-items-center"},s.a.createElement("div",null,s.a.createElement(ye.a,{icon:Oe.f,size:"5x"})),s.a.createElement("div",{className:"h1"},"404 ERROR"),s.a.createElement("div",null,"The requested content was not found."))},$e=(a(387),a(40)),et=a.n($e),tt=(a(388),function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).state={isChecked:!!e.checked},a.onChange=a.onChange.bind(Object(ve.a)(Object(ve.a)(a))),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"componentDidUpdate",value:function(e){e.checked!==this.props.checked&&this.setState({isChecked:this.props.checked})}},{key:"onChange",value:function(e){this.setState({isChecked:!this.state.isChecked}),this.props.onChange(e)}},{key:"render",value:function(){return s.a.createElement("label",{className:"custom-control fill-checkbox"},s.a.createElement("input",{checked:this.state.isChecked,type:"checkbox",onChange:this.props.onChange,className:"fill-control-input"}),s.a.createElement("span",{className:"fill-control-indicator"}),this.props.label?s.a.createElement("span",{className:"fill-control-description"},this.props.label):null)}}]),t}(n.PureComponent)),at=function(e){return s.a.createElement("div",{className:"d-flex ml-2 justify-content-center align-items-center"},s.a.createElement(tt,{checked:e.selected,onChange:e.onChange}))},nt=function(e){return s.a.createElement("div",{className:"wrapper text-4"},s.a.createElement("div",{className:"wrapper align-items-center text-2"},s.a.createElement("div",{className:"text from-name"},e.fromName),s.a.createElement("div",{className:"text"},e.subject)))},st=function(e){return s.a.createElement("div",{className:"wrapper num-4"},s.a.createElement("div",{className:"wrapper num-2"},s.a.createElement("div",{className:"num pr-4"},e.hasAttachment?s.a.createElement(ye.a,{icon:Oe.h}):""),s.a.createElement("div",{className:"num pr-4"},e.formattedDate)))},rt=function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).onSelectionChange=a.onSelectionChange.bind(Object(ve.a)(Object(ve.a)(a))),a.getMessage=a.getMessage.bind(Object(ve.a)(Object(ve.a)(a))),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"onSelectionChange",value:function(e){this.props.onSelectionChange(e.target.checked,this.props.data.id)}},{key:"getMessage",value:function(e){this.props.history.push("/".concat(this.props.data.id))}},{key:"getFromName",value:function(e){return Le(e).name}},{key:"getFormattedDate",value:function(e,t){var a=et()(e);a.isValid()||(a=et()(t.parserFn(t.date)));var n=et()(new Date);return a.format("YYYYMMDD")===n.format("YYYYMMDD")?a.format("h:mm A"):a.year()!==n.year()?a.format("YYYY/MM/DD"):a.format("MMM D")}},{key:"render",value:function(){var e=this.props.data.payload.headers.find(function(e){return"X-RECEIVED"===e.name.toUpperCase()}),t=e?e.value.split(";")[1].trim():"",a=this.getFormattedDate(t,{date:this.props.data.internalDate,parserFn:parseInt}),n=this.props.data.labelIds.indexOf("UNREAD")>-1?" font-weight-bold":"",r=this.props.data.selected?" selected":"",i=this.props.data.payload.headers.find(function(e){return"SUBJECT"===e.name.toUpperCase()}),c=i?i.value:"",l=this.props.data.payload.headers.find(function(e){return"FROM"===e.name.toUpperCase()}),o=l?this.getFromName(l.value):"undefined";return s.a.createElement("div",{className:"d-flex table-row-wrapper".concat(r)},s.a.createElement(at,{selected:this.props.data.selected,onChange:this.onSelectionChange}),s.a.createElement("div",{onClick:this.getMessage,className:"table-row px-2 py-3".concat(n)},s.a.createElement(nt,{fromName:o,subject:c}),s.a.createElement(st,{formattedDate:a,hasAttachment:"multipart/mixed"===this.props.data.payload.mimeType})))}}]),t}(n.PureComponent),it=Object(Ee.a)(rt),ct=function(e){var t=Object(ce.b)().t;return s.a.createElement("div",{className:"btn-group ml-auto"},s.a.createElement("button",{onClick:e.navigateToPrevPage,disabled:null==e.prevToken,className:"btn btn-light bg-white border-1 border-dark px-3 btn-sm",title:t("pager-buttons.previous-page")},s.a.createElement(ye.a,{icon:Oe.a})),s.a.createElement("button",{onClick:e.navigateToNextPage,disabled:null==e.nextToken,className:"btn btn-light bg-white border-1  border-dark px-3 btn-sm",title:t("pager-buttons.next-page")},s.a.createElement(ye.a,{icon:Oe.b})))},lt=(a(389),function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).getClickHandler=a.getClickHandler.bind(Object(ve.a)(Object(ve.a)(a))),a.trashHandler=a.getClickHandler(["TRASH"]),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"getClickHandler",value:function(e){var t=this;return function(a){t.props.onClick(e)}}},{key:"render",value:function(){var e=this.props.t;return s.a.createElement("div",null,s.a.createElement("div",{className:"action-btn"},s.a.createElement(ye.a,{title:e("message-list.move-to-trash"),onClick:this.trashHandler,icon:Oe.l,size:"lg"})))}}]),t}(n.PureComponent)),ot=Object(ce.c)()(lt),ut=function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).onSelectionChange=a.onSelectionChange.bind(Object(ve.a)(Object(ve.a)(a))),a.navigateToNextPage=a.navigateToNextPage.bind(Object(ve.a)(Object(ve.a)(a))),a.navigateToPrevPage=a.navigateToPrevPage.bind(Object(ve.a)(Object(ve.a)(a))),a.modifyMessages=a.modifyMessages.bind(Object(ve.a)(Object(ve.a)(a))),a.state={selectedMessageIds:[]},a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"onSelectionChange",value:function(e){var t=e.target.checked,a=this.props.messagesResult.messages.reduce(function(e,t){return e.push(t.id),e},[]);this.setState({selectedMessageIds:a}),this.props.toggleSelected(a,t),window.dispatchEvent(new CustomEvent("CheckAllclick",{detail:{listMessages:a,chkselected:t}})),t?this.props.addListMessages(a):this.props.deleteListMessages(a)}},{key:"navigateToNextPage",value:function(){this.props.navigateToNextPage(this.props.nextToken)}},{key:"navigateToPrevPage",value:function(){this.props.navigateToPrevPage(this.props.prevToken)}},{key:"modifyMessages",value:function(e,t){var a=this.props.messagesResult.messages.filter(function(e){return e.selected}).map(function(e){return e.id}),n=Object(u.a)({},e&&{addLabelIds:e},t&&{removeLabelIds:t});this.props.modifyMessages(Object(u.a)({ids:a},n))}},{key:"render",value:function(){var e=!1,t=[];return this.props.messagesResult&&(t=this.props.messagesResult.messages.filter(function(e){return e.selected}),e=this.props.messagesResult.messages.length>0&&t.length===this.props.messagesResult.messages.length),s.a.createElement("div",{className:"msg-toolbar"},s.a.createElement("div",{className:"pl-2 py-2 pr-4 d-flex align-items-center bd-highlight "},s.a.createElement("div",{className:"d-flex align-content-center align-items-center"},s.a.createElement("div",null,s.a.createElement(tt,{checked:e,onChange:this.onSelectionChange})),s.a.createElement("div",null),s.a.createElement("div",{className:"ml-auto p-2 bd-highlight"},s.a.createElement("div",null,t.length?s.a.createElement(ot,{onClick:this.modifyMessages}):null))),s.a.createElement(ct,{nextToken:this.props.nextToken,prevToken:this.props.prevToken,navigateToPrevPage:this.navigateToPrevPage,navigateToNextPage:this.navigateToNextPage})))}}]),t}(n.PureComponent),dt=Object(c.b)(function(e){return{messagesResult:e.messagesResult,selectedMessages:e.messageList.selectedMessages}},function(e){return Object(l.b)({toggleSelected:N,modifyMessages:U,deleteListMessages:H,addListMessages:z},e)})(ut),pt=(a(390),function(e){function t(){return Object(de.a)(this,t),Object(me.a)(this,Object(ge.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"render",value:function(){var e=this.props.messagesTotal,t="";return e>0&&(t="".concat(e.toLocaleString()," messages")),s.a.createElement("div",{className:"mt-auto p-2  list-footer"},s.a.createElement("div",{className:"d-flex px-4 h-100 align-items-center"},s.a.createElement("div",{className:"total-count"},t),s.a.createElement("div",{className:"ml-auto "})))}}]),t}(n.PureComponent)),mt=(a(391),a(392),{LIST:1,CONTENT:2,EDIT:3}),gt=function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).state={viewMode:mt.LIST,contentMessageId:void 0,currentLabel:""},a.onSelectionChange=a.onSelectionChange.bind(Object(ve.a)(Object(ve.a)(a))),a.renderView=a.renderView.bind(Object(ve.a)(Object(ve.a)(a))),a.renderMessages=a.renderMessages.bind(Object(ve.a)(Object(ve.a)(a))),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.search,t=0===e.indexOf("?")?e.slice(1):null;t&&0===this.props.messagesResult.pageTokens.length&&this.props.addInitialPageToken(t);var a=""===this.props.searchQuery?[this.props.parentLabel.id]:void 0;this.props.getLabelMessages(Object(u.a)({},a&&{labelIds:a},{pageToken:t}))}},{key:"componentDidUpdate",value:function(e,t){if(e.location.search!==this.props.location.search){var a=this.props.location.search,n=0===a.indexOf("?")?a.slice(1):null,s=""===this.props.searchQuery?[this.props.parentLabel.id]:void 0;this.props.getLabelMessages(Object(u.a)({},s&&{labelIds:s},{pageToken:n}))}}},{key:"onSelectionChange",value:function(e,t){this.props.toggleSelected([t],e),window.dispatchEvent(new CustomEvent("Checkclick",{detail:{name:t,chkselected:e}})),e?this.props.addMessage(t):this.props.deleteMessage(t)}},{key:"renderSpinner",value:function(){return s.a.createElement("div",{className:"d-flex h-100 justify-content-center align-items-center  "},s.a.createElement(ye.a,{icon:Oe.k,spin:!0,size:"3x"}))}},{key:"renderMessages",value:function(){var e=this,t=this.props.t;return this.props.messagesResult.loading?this.renderSpinner():0===this.props.messagesResult.messages.length?s.a.createElement("div",{className:"p-4 text-center"},t("message-list.no-message")):this.props.messagesResult.messages.map(function(t){return e.props.selectedMessages.find(function(e){return e.id===t.id})&&(t.selected=!0),s.a.createElement(it,{data:t,key:t.id,onSelectionChange:e.onSelectionChange,onClick:e.getMessage})})}},{key:"renderView",value:function(){switch(this.state.viewMode){case mt.EDIT:return this.renderEditView();default:return this.renderMessages()}}},{key:"getPageTokens",value:function(){if(this.props.messagesResult.loading)return{nextToken:null,prevToken:null};var e,t=this.props,a=t.messagesResult,n=t.location,s=n.pathname,r=a.nextPageToken,i=n.search,c=0===i.indexOf("?")?i.slice(1):null;if(c){var l=a.pageTokens.indexOf(c);l>-1?(r=a.pageTokens[l+1],e=(e=a.pageTokens[l-1])?"".concat(s,"?").concat(e):s):e=s}return{nextToken:r=r?"".concat(s,"?").concat(r):null,prevToken:e}}},{key:"render",value:function(){var e=this.props.messagesResult,t=e.label?e.label.result.messagesTotal:0,a=this.getPageTokens(),n=a.nextToken,r=a.prevToken;return s.a.createElement(s.a.Fragment,null,s.a.createElement(dt,{nextToken:n,prevToken:r,navigateToNextPage:this.props.navigateToNextPage,navigateToPrevPage:this.props.navigateToPrevPage}),s.a.createElement(ze.a,{className:"container-fluid no-gutters px-0 message-list-container"},this.renderView()),s.a.createElement(pt,{messagesTotal:t}))}}]),t}(n.PureComponent),ht=Object(l.d)(Ee.a,Object(ce.c)(),Object(c.b)(function(e){return{selectedMessages:e.messageList.selectedMessages}},function(e){return Object(l.b)({addMessage:G,deleteMessage:F},e)}))(gt),bt=a(433),ft=(a(421),function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).trashHandler=a.getClickHandler(["TRASH"]),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"getClickHandler",value:function(e){var t=this;return function(a){t.props.onClick(e)}}},{key:"render",value:function(){var e=this.props.t;if(!this.props.messageResult.result)return null;for(var t,a,n,r=this.props.messageResult.result.messageHeaders,i=0;i<r.length;i++){var c=r[i];switch(c.name){case"Subject":n=c;break;case"From":t||(t=c);break;case"Reply-To":t=c;break;case"Cc":a=c}}var l=Le(t.value),o=r.find(function(e){return"X-Received"===e.name}),d=o?o.value.split(";")[1].trim():"",p=et()(d);p.isValid()||(p=et()(parseInt(this.props.messageResult.result.internalDate)));var m="<p>On ".concat(p.format("MMMM Do YYYY, h:mm:ss a")," < ").concat(l.email," > wrote:</p>"),g=Object(u.a)({subject:"Re: ".concat(n.value),to:l.email,content:"<p>&nbsp;</p>\n          <p>&nbsp;</p>\n          <p>&nbsp;</p>\n          ".concat(m,"\n          <blockquote>").concat(this.props.messageResult.body,"</blockquote>")},a&&{cc:a.value});return s.a.createElement("div",{className:"d-flex justify-content-center align-items-center message-toolbar"},s.a.createElement("div",{className:"action-btns"},s.a.createElement("div",{className:"action-btn mr-2"},s.a.createElement("button",{className:"btn",onClick:this.trashHandler},s.a.createElement(ye.a,{title:e("message-toolbar.move-to-trash"),icon:Oe.l,size:"lg"}))),s.a.createElement("div",{className:"action-btn mr-2"},s.a.createElement(Fe,g,s.a.createElement("button",{className:"btn"},s.a.createElement(ye.a,{title:e("message-toolbar.reply"),icon:Oe.i,size:"lg"}))))))}}]),t}(n.PureComponent)),vt=Object(ce.c)()(ft);a(422);function Et(e,t,a){t=t||"",a=a||512;for(var n=atob(e),s=[],r=0;r<n.length;r+=a){for(var i=n.slice(r,r+a),c=new Array(i.length),l=0;l<i.length;l++)c[l]=i.charCodeAt(l);var o=new Uint8Array(c);s.push(o)}return new Blob(s,{type:t})}function yt(e,t,a){var n=t.body.attachmentId;window.gapi.client.gmail.users.messages.attachments.get({id:n,messageId:e,userId:"me"}).execute(function(e){a(t.filename,t.mimeType,e)})}function Ot(e,t){var a=document.createElement("a"),n=document.createTextNode(t);return a.appendChild(n),a.href=e,a.title=t,a.download=t,a.style.textDecoration="none",a.style.padding="5px",a.style.margin="15px 0",a.style.clear="both",a}function jt(e){var t=document.createElement("span");t.style.whiteSpace="nowrap",t.style.backgroundColor="#fafafa",t.style.border="solid 1px #aaa",t.style.padding="5px",t.style.margin="10px",t.style.display="inline-block";var a=function(e){var t,a=document.createElement("img");switch(e){case"image/png":t="../assets/img/file-extensions/png.png";break;case"image/jpeg":t="../assets/img/file-extensions/jpg.png";break;case"application/pdf":t="../assets/img/file-extensions/pdf.png";break;case"text/plain":t="../assets/img/file-extensions/txt.png";break;case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":t="../assets/img/file-extensions/doc.png";break;default:t="../assets/img/file-extensions/default.png"}return a.src=t,a.style.alt="Attached file",a.style.display="inline-block",a.style.verticalAlign="middle",a}(e);return t.appendChild(a),t}var kt=function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).state={errorMessage:void 0},a.iframeRef=s.a.createRef(),a.modifyMessage=a.modifyMessage.bind(Object(ve.a)(Object(ve.a)(a))),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"componentDidMount",value:function(e){var t=this.props.match.params.id;this.props.getEmailMessage(t)}},{key:"componentDidUpdate",value:function(e){var t=this.props.emailMessageResult;if(!t.loading)if(t.failed)this.state.errorMessage||this.setState({errorMessage:t.error.result.error.message,modal:!0});else if(this.iframeRef.current){var a=this.iframeRef.current.contentWindow.document.body;a.style.margin="0px",a.style.fontFamily="Arial, Helvetica, sans-serif",a.style.fontSize="13px",a.innerHTML=this.props.emailMessageResult.body;var n=t.attach;if("undefined"!==typeof n&&n.length>0){var s=document.getElementById("message-iframe"),r=function(){var e=document.createElement("div");return e.style.height="30px",e.id="Dividier",e}();s.contentDocument.body.appendChild(r);for(var i=0;i<n.length;i++)n[i].filename&&n[i].filename.length>0&&yt(t.id,n[i],function(e,t,a){var n=Et(a.data.replace(/-/g,"+").replace(/_/g,"/"),t,a.size),r=Ot(URL.createObjectURL(n),e),i=jt(t);i.appendChild(r),s.contentDocument.body.appendChild(i)})}}}},{key:"renderSpinner",value:function(){return s.a.createElement("div",{className:"d-flex h-100 justify-content-center align-items-center  "},s.a.createElement(ye.a,{icon:Oe.k,spin:!0,size:"3x"}))}},{key:"renderErrorModal",value:function(){return s.a.createElement(bt.a,{to:"/notfound"})}},{key:"modifyMessage",value:function(e,t){var a=this.props.emailMessageResult.result.id,n=Object(u.a)({},e&&{addLabelIds:e},t&&{removeLabelIds:t});this.props.modifyMessages(Object(u.a)({ids:[a]},n)),this.props.history.goBack()}},{key:"render",value:function(){return this.props.emailMessageResult.loading?this.renderSpinner():s.a.createElement(s.a.Fragment,null,s.a.createElement(vt,{onClick:this.modifyMessage,messageResult:this.props.emailMessageResult}),s.a.createElement("div",{className:"d-flex justify-content-center align-items-center message-content"},this.props.emailMessageResult.loading?this.renderSpinner():null,this.state.errorMessage?this.renderErrorModal():s.a.createElement("iframe",{ref:this.iframeRef,title:"Message contents",id:"message-iframe",style:{display:this.props.emailMessageResult.loading?"none":"block"}})))}}]),t}(n.Component),St=Object(l.d)(Ee.a,Object(c.b)(function(e){return{emailMessageResult:e.emailMessageResult}},function(e){return Object(l.b)({getEmailMessage:A,modifyMessages:U},e)}))(kt),Mt=a(435),Tt=function(){return new Promise(function(e,t){window.gapi.client.init({apiKey:"AIzaSyD6fV04pR57Wc8ZnRZ-UiguUut12uaNYA0",clientId:"50415328365-v7emm6mrvs61s5jkiheofdbirer2jog0.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/gmail/v1/rest"],scope:"https://mail.google.com/"}).then(function(a){var n=window.gapi.auth2.getAuthInstance();n.isSignedIn.get()?(n.isSignedIn.listen(function(e){Ct(e)}),console.log("AUTH_SUCCESS from checkSignInStatus"),e(n.currentUser.Ab)):t()}).catch(function(e){t(e)})})},Ct=function(e){},It=a(41),wt=(a(426),a(48)),Lt=(a(32),a(47),function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).getLabelList=a.getLabelList.bind(Object(ve.a)(Object(ve.a)(a))),a.getLabelMessages=a.getLabelMessages.bind(Object(ve.a)(Object(ve.a)(a))),a.renderLabelRoutes=a.renderLabelRoutes.bind(Object(ve.a)(Object(ve.a)(a))),a.loadLabelMessages=a.loadLabelMessages.bind(Object(ve.a)(Object(ve.a)(a))),a.navigateToNextPage=a.navigateToNextPage.bind(Object(ve.a)(Object(ve.a)(a))),a.navigateToPrevPage=a.navigateToPrevPage.bind(Object(ve.a)(Object(ve.a)(a))),a.addInitialPageToken=a.addInitialPageToken.bind(Object(ve.a)(Object(ve.a)(a))),a.onSignout=a.onSignout.bind(Object(ve.a)(Object(ve.a)(a))),a.state={isVisible:!0,fluid:!0,customAnimation:!1,slow:!1,size:.25},a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"componentDidMount",value:function(){this.getLabelList(),window.addEventListener("toggleClock",function(e){alert(e.detail.name)})}},{key:"componentDidUpdate",value:function(e,t){e.signedInUser!==this.props.signedInUser&&this.setState({signedInUser:this.props.signedInUser});var a=this.props.labelsResult.labels,n=this.props.location.pathname,s=a.find(function(e){return e.selected}),r=a.find(function(e){return e.id.toLowerCase()===n.slice(1)});s?r&&s.id!==r.id&&this.props.selectLabel(r.id):r&&""===this.props.searchQuery&&this.props.selectLabel(r.id)}},{key:"navigateToNextPage",value:function(e){var t=this.props.location.search,a=0===t.indexOf("?")?t.slice(1):"";this.props.setPageTokens({prevPageToken:a}),this.props.history.push(e)}},{key:"navigateToPrevPage",value:function(e){this.props.history.push(e)}},{key:"loadLabelMessages",value:function(e){var t=this.props.searchQuery;this.props.clearPageTokens(),this.props.selectLabel(e.id);var a="/".concat(e.id.toLowerCase());if(t&&""!==t&&(this.props.setSearchQuery(""),a===this.props.location.pathname))return void this.getLabelMessages({labelIds:[e.id]});this.props.history.push("/".concat(e.id.toLowerCase()))}},{key:"registerConnectorApp",value:function(){if(!document.getElementById("main-lexon-connector"))try{Object(wt.a)("lex-on-connector",function(){return a.e(3).then(a.bind(null,438))},function(e){return e.pathname.startsWith("/")}),Object(wt.b)()}catch(e){console.error(e)}}},{key:"getLabelList",value:function(){this.props.getLabels()}},{key:"getLabelMessages",value:function(e){var t=e.labelIds,a=e.q,n=e.pageToken;this.props.emptyLabelMessages(),this.props.getLabelMessages({labelIds:t,q:a,pageToken:n}),this.registerConnectorApp()}},{key:"addInitialPageToken",value:function(e){this.props.addInitialPageToken(e)}},{key:"renderLabelRoutes",value:function(){var e=this;return this.props.labelsResult.labels.map(function(t){return s.a.createElement(fe.a,{key:t.id+"_route",exact:!0,path:"/"+t.id,render:function(t){var a=e;return s.a.createElement(ht,Object.assign({},t,{getLabelMessages:e.getLabelMessages,messagesResult:e.props.messagesResult,toggleSelected:e.props.toggleSelected,navigateToNextPage:e.navigateToNextPage,navigateToPrevPage:e.navigateToPrevPage,pageTokens:e.props.pageTokens,addInitialPageToken:e.addInitialPageToken,parentLabel:a.props.labelsResult.labels.find(function(e){return e.id===t.match.path.slice(1)}),searchQuery:e.props.searchQuery}))}})})}},{key:"renderSpinner",value:function(){return s.a.createElement("div",{className:"d-flex h-100 align-items-center justify-content-center"},s.a.createElement(ye.a,{icon:Oe.k,spin:!0,size:"3x"}))}},{key:"onSignout",value:function(){var e=this;window.gapi.auth2.getAuthInstance().signOut().then(function(t){e.props.history.replace("inbox"),window.location.reload(!0)})}},{key:"renderInboxViewport",value:function(){return this.props.labelsResult.labels.length<1?this.renderSpinner():s.a.createElement(n.Fragment,null,s.a.createElement(Ce,{googleUser:this.props.googleUser,onSignout:this.onSignout,setSearchQuery:this.props.setSearchQuery,getLabelMessages:this.getLabelMessages,searchQuery:this.props.searchQuery}),s.a.createElement("section",{className:"main hbox space-between"},s.a.createElement(It.a,{orientation:"vertical"},s.a.createElement(It.b,{maxSize:300,minSize:150,className:"left-pane",propagateDimensionsRate:200,propagateDimensions:!0,flex:.2},s.a.createElement(ze.a,null,s.a.createElement("div",{className:"pane-content"},s.a.createElement(We,{getLabelList:this.getLabelList,pathname:this.props.location.pathname,labelsResult:this.props.labelsResult,onLabelClick:this.loadLabelMessages})))),s.a.createElement(It.c,{propagate:!0}),s.a.createElement(It.b,{minSize:400,className:"middle-pane",propagateDimensionsRate:400,propagateDimensions:!0,flex:.6},s.a.createElement(ze.a,null,s.a.createElement("div",{className:"pane-content",style:{height:"60%"}},s.a.createElement("article",{className:"d-flex flex-column"},s.a.createElement(Mt.a,null,this.renderLabelRoutes(),s.a.createElement(fe.a,{exact:!0,path:"/notfound",component:Je}),s.a.createElement(fe.a,{exact:!0,path:"/:id([a-zA-Z0-9]+)",component:St})))))),s.a.createElement(It.c,{propagate:!0}),s.a.createElement(It.b,{minSize:"400",className:"right-pane",propagateDimensionsRate:400,propagateDimensions:!0,flex:.2},s.a.createElement("div",{id:"main-content",className:"connector",style:{backgroundImage:"url(assets/img/settings-gears.svg)",backgroundSize:"120px",backgroundPosition:"center 5%",backgroundRepeat:"no-repeat"}},s.a.createElement("div",{className:"conector"},s.a.createElement(Xe,null)))))))}},{key:"render",value:function(){return this.renderInboxViewport()}}]),t}(n.Component)),xt=Object(l.d)(Ee.a,Object(c.b)(function(e){return{labelsResult:e.labelsResult,messagesResult:e.messagesResult,pageTokens:e.pageTokens,searchQuery:e.searchQuery}},function(e){return Object(l.b)({getLabels:Y,getLabelMessages:I,emptyLabelMessages:x,toggleSelected:N,selectLabel:Q,setPageTokens:L,addInitialPageToken:_,clearPageTokens:D,setSearchQuery:w},e)}))(Lt),Nt=a(71),At=function(e){function t(){return Object(de.a)(this,t),Object(me.a)(this,Object(ge.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"d-flex align-content-center align-items-center w-100 h-100 text-center"},s.a.createElement("div",{className:"mx-auto"},s.a.createElement(Nt.a,{onClick:this.props.onSignIn})))}}]),t}(n.Component),Pt=function(e){function t(){return Object(de.a)(this,t),Object(me.a)(this,Object(ge.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"d-flex align-content-center align-items-center w-100 h-100 text-center"},s.a.createElement("div",{className:"mx-auto"},s.a.createElement(Nt.a,{label:"Signing in...",disabled:!0})))}}]),t}(n.Component),Rt=(a(427),function(e){function t(e){var a;return Object(de.a)(this,t),(a=Object(me.a)(this,Object(ge.a)(t).call(this,e))).state={signInStatus:d,googleUser:void 0,updateDefaultAccount:!1,fetchUpdateDefaultAccount:!1,userIdisNull:!1},a.init=a.init.bind(Object(ve.a)(Object(ve.a)(a))),a.initClient=a.initClient.bind(Object(ve.a)(Object(ve.a)(a))),a.onSignout=a.onSignout.bind(Object(ve.a)(Object(ve.a)(a))),a.onSignInSuccess=a.onSignInSuccess.bind(Object(ve.a)(Object(ve.a)(a))),a.onSignIn=a.onSignIn.bind(Object(ve.a)(Object(ve.a)(a))),a}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(new Promise(function(e,t){var a=document.createElement("script");a.src="https://apis.google.com/js/api.js",a.async=!0,a.defer=!0,a.onload=function(){a.onload=function(){},e()},a.onreadystatechange=function(){"complete"===a.readyState&&a.onload()},document.body.appendChild(a)}).then(this.init),this.state.updateDefaultAccount)this.setState({userIdisNull:!0});else{var t=this.props.match.params.id;if(console.log("userId -> ",t),null!=t){var a="".concat(p.url.URL_UPDATE_DEFAULTACCOUNT,"/").concat(t,"/").concat("GOOGLE");fetch(a,{method:"POST"}).then(function(e){return e.json()}).then(function(a){console.log(a),e.setState({updateDefaultAccount:!0}),e.setState({fetchUpdateDefaultAccount:!0}),e.props.storeUser(t)})}}this.props.location.pathname="/inbox"}},{key:"init",value:function(){window.gapi.load("client:auth2",this.initClient)}},{key:"initClient",value:function(){var e=this;Tt().then(this.onSignInSuccess).catch(function(t){e.setState({signInStatus:"AUTH_FAIL"})})}},{key:"onSignout",value:function(){this.props.signOut()}},{key:"onSignIn",value:function(){window.gapi.auth2.getAuthInstance().signIn().then(this.onSignInSuccess)}},{key:"onSignInSuccess",value:function(e){this.setState({signInStatus:"AUTH_SUCCESS",googleUser:e})}},{key:"renderView",value:function(){var e=this.state.signInStatus;return"AUTH_SUCCESS"===e?s.a.createElement(xt,{googleUser:this.state.googleUser}):"AUTH_IN_PROGRESS"===e?s.a.createElement(Pt,null):s.a.createElement(At,{onSignIn:this.onSignIn})}},{key:"render",value:function(){return!this.state.fetchUpdateDefaultAccount&&this.state.userIdisNull?null:s.a.createElement(s.a.Fragment,null,this.renderView())}}]),t}(n.Component)),_t=Object(l.d)(Ee.a,Object(c.b)(function(e){return{userId:e.storeUser.userId}},function(e){return Object(l.b)({storeUser:m},e)}))(Rt),Dt=(a(428),function(e){function t(){return Object(de.a)(this,t),Object(me.a)(this,Object(ge.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(pe.a)(t,[{key:"render",value:function(){return s.a.createElement(be.a,null,s.a.createElement(fe.a,{path:"/:id?",component:_t}))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(c.a,{store:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],Object(l.e)(ie,Object(l.a)(o.a))}()},s.a.createElement(ce.a,{i18n:ue},s.a.createElement(Dt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[153,1,2]]]);
//# sourceMappingURL=main.c497e256.chunk.js.map